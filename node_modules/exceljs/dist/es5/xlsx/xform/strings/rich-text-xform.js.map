<<<<<<< HEAD
{"version":3,"sources":["../../../../../lib/xlsx/xform/strings/rich-text-xform.js"],"names":["TextXform","require","FontXform","BaseXform","RichTextXform","model","xmlStream","openNode","font","fontXform","render","textXform","text","closeNode","node","parser","parseOpen","name","parseText","undefined","parseClose","_textXform","_fontXform","FONT_OPTIONS","tagName","fontNameTag","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,cAAD,CAAzB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,qBAAD,CAAzB;;AAEA,IAAME,SAAS,GAAGF,OAAO,CAAC,eAAD,CAAzB,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;IAEMG,a;;;;;AACJ,yBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB;AAEA,UAAKA,KAAL,GAAaA,KAAb;AAHiB;AAIlB;;;;2BAcMC,S,EAAWD,K,EAAO;AACvBA,MAAAA,KAAK,GAAGA,KAAK,IAAI,KAAKA,KAAtB;AAEAC,MAAAA,SAAS,CAACC,QAAV,CAAmB,GAAnB;;AACA,UAAIF,KAAK,CAACG,IAAV,EAAgB;AACd,aAAKC,SAAL,CAAeC,MAAf,CAAsBJ,SAAtB,EAAiCD,KAAK,CAACG,IAAvC;AACD;;AACD,WAAKG,SAAL,CAAeD,MAAf,CAAsBJ,SAAtB,EAAiCD,KAAK,CAACO,IAAvC;AACAN,MAAAA,SAAS,CAACO,SAAV;AACD;;;8BAESC,I,EAAM;AACd,UAAI,KAAKC,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYC,SAAZ,CAAsBF,IAAtB;AACA,eAAO,IAAP;AACD;;AACD,cAAQA,IAAI,CAACG,IAAb;AACE,aAAK,GAAL;AACE,eAAKZ,KAAL,GAAa,EAAb;AACA,iBAAO,IAAP;;AACF,aAAK,GAAL;AACE,eAAKU,MAAL,GAAc,KAAKJ,SAAnB;AACA,eAAKI,MAAL,CAAYC,SAAZ,CAAsBF,IAAtB;AACA,iBAAO,IAAP;;AACF,aAAK,KAAL;AACE,eAAKC,MAAL,GAAc,KAAKN,SAAnB;AACA,eAAKM,MAAL,CAAYC,SAAZ,CAAsBF,IAAtB;AACA,iBAAO,IAAP;;AACF;AACE,iBAAO,KAAP;AAbJ;AAeD;;;8BAESF,I,EAAM;AACd,UAAI,KAAKG,MAAT,EAAiB;AACf,aAAKA,MAAL,CAAYG,SAAZ,CAAsBN,IAAtB;AACD;AACF;;;+BAEUK,I,EAAM;AACf,cAAQA,IAAR;AACE,aAAK,GAAL;AACE,iBAAO,KAAP;;AACF,aAAK,GAAL;AACE,eAAKZ,KAAL,CAAWO,IAAX,GAAkB,KAAKG,MAAL,CAAYV,KAA9B;AACA,eAAKU,MAAL,GAAcI,SAAd;AACA,iBAAO,IAAP;;AACF,aAAK,KAAL;AACE,eAAKd,KAAL,CAAWG,IAAX,GAAkB,KAAKO,MAAL,CAAYV,KAA9B;AACA,eAAKU,MAAL,GAAcI,SAAd;AACA,iBAAO,IAAP;;AACF;AACE,cAAI,KAAKJ,MAAT,EAAiB;AACf,iBAAKA,MAAL,CAAYK,UAAZ,CAAuBH,IAAvB;AACD;;AACD,iBAAO,IAAP;AAfJ;AAiBD;;;wBArES;AACR,aAAO,GAAP;AACD;;;wBAEe;AACd,aAAO,KAAKI,UAAL,KAAoB,KAAKA,UAAL,GAAkB,IAAIrB,SAAJ,EAAtC,CAAP;AACD;;;wBAEe;AACd,aAAO,KAAKsB,UAAL,KAAoB,KAAKA,UAAL,GAAkB,IAAIpB,SAAJ,CAAcE,aAAa,CAACmB,YAA5B,CAAtC,CAAP;AACD;;;;EAjByBpB,S;;AA+E5BC,aAAa,CAACmB,YAAd,GAA6B;AAC3BC,EAAAA,OAAO,EAAE,KADkB;AAE3BC,EAAAA,WAAW,EAAE;AAFc,CAA7B;AAKAC,MAAM,CAACC,OAAP,GAAiBvB,aAAjB","sourcesContent":["const TextXform = require('./text-xform');\r\nconst FontXform = require('../style/font-xform');\r\n\r\nconst BaseXform = require('../base-xform');\r\n\r\n// <r>\r\n//   <rPr>\r\n//     <sz val=\"11\"/>\r\n//     <color theme=\"1\" tint=\"5\"/>\r\n//     <rFont val=\"Calibri\"/>\r\n//     <family val=\"2\"/>\r\n//     <scheme val=\"minor\"/>\r\n//   </rPr>\r\n//   <t xml:space=\"preserve\"> is </t>\r\n// </r>\r\n\r\nclass RichTextXform extends BaseXform {\r\n  constructor(model) {\r\n    super();\r\n\r\n    this.model = model;\r\n  }\r\n\r\n  get tag() {\r\n    return 'r';\r\n  }\r\n\r\n  get textXform() {\r\n    return this._textXform || (this._textXform = new TextXform());\r\n  }\r\n\r\n  get fontXform() {\r\n    return this._fontXform || (this._fontXform = new FontXform(RichTextXform.FONT_OPTIONS));\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    model = model || this.model;\r\n\r\n    xmlStream.openNode('r');\r\n    if (model.font) {\r\n      this.fontXform.render(xmlStream, model.font);\r\n    }\r\n    this.textXform.render(xmlStream, model.text);\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case 'r':\r\n        this.model = {};\r\n        return true;\r\n      case 't':\r\n        this.parser = this.textXform;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      case 'rPr':\r\n        this.parser = this.fontXform;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    switch (name) {\r\n      case 'r':\r\n        return false;\r\n      case 't':\r\n        this.model.text = this.parser.model;\r\n        this.parser = undefined;\r\n        return true;\r\n      case 'rPr':\r\n        this.model.font = this.parser.model;\r\n        this.parser = undefined;\r\n        return true;\r\n      default:\r\n        if (this.parser) {\r\n          this.parser.parseClose(name);\r\n        }\r\n        return true;\r\n    }\r\n  }\r\n}\r\n\r\nRichTextXform.FONT_OPTIONS = {\r\n  tagName: 'rPr',\r\n  fontNameTag: 'rFont',\r\n};\r\n\r\nmodule.exports = RichTextXform;\r\n"],"file":"rich-text-xform.js"}
=======
{"version":3,"file":"rich-text-xform.js","names":["TextXform","require","FontXform","BaseXform","RichTextXform","constructor","model","tag","textXform","_textXform","fontXform","_fontXform","FONT_OPTIONS","render","xmlStream","openNode","font","text","closeNode","parseOpen","node","parser","name","parseText","parseClose","undefined","tagName","fontNameTag","module","exports"],"sources":["../../../../../lib/xlsx/xform/strings/rich-text-xform.js"],"sourcesContent":["const TextXform = require('./text-xform');\nconst FontXform = require('../style/font-xform');\n\nconst BaseXform = require('../base-xform');\n\n// <r>\n//   <rPr>\n//     <sz val=\"11\"/>\n//     <color theme=\"1\" tint=\"5\"/>\n//     <rFont val=\"Calibri\"/>\n//     <family val=\"2\"/>\n//     <scheme val=\"minor\"/>\n//   </rPr>\n//   <t xml:space=\"preserve\"> is </t>\n// </r>\n\nclass RichTextXform extends BaseXform {\n  constructor(model) {\n    super();\n\n    this.model = model;\n  }\n\n  get tag() {\n    return 'r';\n  }\n\n  get textXform() {\n    return this._textXform || (this._textXform = new TextXform());\n  }\n\n  get fontXform() {\n    return this._fontXform || (this._fontXform = new FontXform(RichTextXform.FONT_OPTIONS));\n  }\n\n  render(xmlStream, model) {\n    model = model || this.model;\n\n    xmlStream.openNode('r');\n    if (model.font) {\n      this.fontXform.render(xmlStream, model.font);\n    }\n    this.textXform.render(xmlStream, model.text);\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    switch (node.name) {\n      case 'r':\n        this.model = {};\n        return true;\n      case 't':\n        this.parser = this.textXform;\n        this.parser.parseOpen(node);\n        return true;\n      case 'rPr':\n        this.parser = this.fontXform;\n        this.parser.parseOpen(node);\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    switch (name) {\n      case 'r':\n        return false;\n      case 't':\n        this.model.text = this.parser.model;\n        this.parser = undefined;\n        return true;\n      case 'rPr':\n        this.model.font = this.parser.model;\n        this.parser = undefined;\n        return true;\n      default:\n        if (this.parser) {\n          this.parser.parseClose(name);\n        }\n        return true;\n    }\n  }\n}\n\nRichTextXform.FONT_OPTIONS = {\n  tagName: 'rPr',\n  fontNameTag: 'rFont',\n};\n\nmodule.exports = RichTextXform;\n"],"mappings":"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"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
