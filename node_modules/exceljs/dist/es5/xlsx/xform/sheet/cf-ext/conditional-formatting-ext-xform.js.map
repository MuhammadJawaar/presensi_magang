<<<<<<< HEAD
{"version":3,"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/conditional-formatting-ext-xform.js"],"names":["CompositeXform","require","SqRefExtXform","CfRuleExtXform","ConditionalFormattingExtXform","map","sqRef","cfRule","model","options","rules","forEach","rule","prepare","xmlStream","some","isExt","openNode","tag","filter","render","ref","closeNode","name","parser","push","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,cAAc,GAAGC,OAAO,CAAC,uBAAD,CAA9B;;AAEA,IAAMC,aAAa,GAAGD,OAAO,CAAC,mBAAD,CAA7B;;AACA,IAAME,cAAc,GAAGF,OAAO,CAAC,qBAAD,CAA9B;;IAEMG,6B;;;;;AACJ,2CAAc;AAAA;;AAAA;;AACZ;AAEA,UAAKC,GAAL,GAAW;AACT,kBAAa,MAAKC,KAAL,GAAa,IAAIJ,aAAJ,EADjB;AAET,oBAAe,MAAKK,MAAL,GAAc,IAAIJ,cAAJ;AAFpB,KAAX;AAHY;AAOb;;;;4BAMOK,K,EAAOC,O,EAAS;AAAA;;AACtBD,MAAAA,KAAK,CAACE,KAAN,CAAYC,OAAZ,CAAoB,UAAAC,IAAI,EAAI;AAC1B,QAAA,MAAI,CAACL,MAAL,CAAYM,OAAZ,CAAoBD,IAApB,EAA0BH,OAA1B;AACD,OAFD;AAGD;;;2BAEMK,S,EAAWN,K,EAAO;AAAA;;AACvB,UAAI,CAACA,KAAK,CAACE,KAAN,CAAYK,IAAZ,CAAiBZ,cAAc,CAACa,KAAhC,CAAL,EAA6C;AAC3C;AACD;;AAEDF,MAAAA,SAAS,CAACG,QAAV,CAAmB,KAAKC,GAAxB,EAA6B;AAC3B,oBAAY;AADe,OAA7B;AAIAV,MAAAA,KAAK,CAACE,KAAN,CAAYS,MAAZ,CAAmBhB,cAAc,CAACa,KAAlC,EAAyCL,OAAzC,CAAiD,UAAAC,IAAI;AAAA,eAAI,MAAI,CAACL,MAAL,CAAYa,MAAZ,CAAmBN,SAAnB,EAA8BF,IAA9B,CAAJ;AAAA,OAArD,EATuB,CAWvB;;AACA,WAAKN,KAAL,CAAWc,MAAX,CAAkBN,SAAlB,EAA6BN,KAAK,CAACa,GAAnC;AAEAP,MAAAA,SAAS,CAACQ,SAAV;AACD;;;qCAEgB;AACf,aAAO;AACLZ,QAAAA,KAAK,EAAE;AADF,OAAP;AAGD;;;kCAEaa,I,EAAMC,M,EAAQ;AAC1B,cAAQD,IAAR;AACE,aAAK,UAAL;AACE,eAAKf,KAAL,CAAWa,GAAX,GAAiBG,MAAM,CAAChB,KAAxB;AACA;;AAEF,aAAK,YAAL;AACE,eAAKA,KAAL,CAAWE,KAAX,CAAiBe,IAAjB,CAAsBD,MAAM,CAAChB,KAA7B;AACA;AAPJ;AASD;;;wBA3CS;AACR,aAAO,2BAAP;AACD;;;;EAZyCR,c;;AAwD5C0B,MAAM,CAACC,OAAP,GAAiBvB,6BAAjB","sourcesContent":["const CompositeXform = require('../../composite-xform');\r\n\r\nconst SqRefExtXform = require('./sqref-ext-xform');\r\nconst CfRuleExtXform = require('./cf-rule-ext-xform');\r\n\r\nclass ConditionalFormattingExtXform extends CompositeXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.map = {\r\n      'xm:sqref': (this.sqRef = new SqRefExtXform()),\r\n      'x14:cfRule': (this.cfRule = new CfRuleExtXform()),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'x14:conditionalFormatting';\r\n  }\r\n\r\n  prepare(model, options) {\r\n    model.rules.forEach(rule => {\r\n      this.cfRule.prepare(rule, options);\r\n    });\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (!model.rules.some(CfRuleExtXform.isExt)) {\r\n      return;\r\n    }\r\n\r\n    xmlStream.openNode(this.tag, {\r\n      'xmlns:xm': 'http://schemas.microsoft.com/office/excel/2006/main',\r\n    });\r\n\r\n    model.rules.filter(CfRuleExtXform.isExt).forEach(rule => this.cfRule.render(xmlStream, rule));\r\n\r\n    // for some odd reason, Excel needs the <xm:sqref> node to be after the rules\r\n    this.sqRef.render(xmlStream, model.ref);\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  createNewModel() {\r\n    return {\r\n      rules: [],\r\n    };\r\n  }\r\n\r\n  onParserClose(name, parser) {\r\n    switch (name) {\r\n      case 'xm:sqref':\r\n        this.model.ref = parser.model;\r\n        break;\r\n\r\n      case 'x14:cfRule':\r\n        this.model.rules.push(parser.model);\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = ConditionalFormattingExtXform;\r\n"],"file":"conditional-formatting-ext-xform.js"}
=======
{"version":3,"file":"conditional-formatting-ext-xform.js","names":["CompositeXform","require","SqRefExtXform","CfRuleExtXform","ConditionalFormattingExtXform","constructor","map","sqRef","cfRule","tag","prepare","model","options","rules","forEach","rule","render","xmlStream","some","isExt","openNode","filter","ref","closeNode","createNewModel","onParserClose","name","parser","push","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf-ext/conditional-formatting-ext-xform.js"],"sourcesContent":["const CompositeXform = require('../../composite-xform');\n\nconst SqRefExtXform = require('./sqref-ext-xform');\nconst CfRuleExtXform = require('./cf-rule-ext-xform');\n\nclass ConditionalFormattingExtXform extends CompositeXform {\n  constructor() {\n    super();\n\n    this.map = {\n      'xm:sqref': (this.sqRef = new SqRefExtXform()),\n      'x14:cfRule': (this.cfRule = new CfRuleExtXform()),\n    };\n  }\n\n  get tag() {\n    return 'x14:conditionalFormatting';\n  }\n\n  prepare(model, options) {\n    model.rules.forEach(rule => {\n      this.cfRule.prepare(rule, options);\n    });\n  }\n\n  render(xmlStream, model) {\n    if (!model.rules.some(CfRuleExtXform.isExt)) {\n      return;\n    }\n\n    xmlStream.openNode(this.tag, {\n      'xmlns:xm': 'http://schemas.microsoft.com/office/excel/2006/main',\n    });\n\n    model.rules.filter(CfRuleExtXform.isExt).forEach(rule => this.cfRule.render(xmlStream, rule));\n\n    // for some odd reason, Excel needs the <xm:sqref> node to be after the rules\n    this.sqRef.render(xmlStream, model.ref);\n\n    xmlStream.closeNode();\n  }\n\n  createNewModel() {\n    return {\n      rules: [],\n    };\n  }\n\n  onParserClose(name, parser) {\n    switch (name) {\n      case 'xm:sqref':\n        this.model.ref = parser.model;\n        break;\n\n      case 'x14:cfRule':\n        this.model.rules.push(parser.model);\n        break;\n    }\n  }\n}\n\nmodule.exports = ConditionalFormattingExtXform;\n"],"mappings":";;AAAA,MAAMA,cAAc,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAEvD,MAAMC,aAAa,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AAClD,MAAME,cAAc,GAAGF,OAAO,CAAC,qBAAqB,CAAC;AAErD,MAAMG,6BAA6B,SAASJ,cAAc,CAAC;EACzDK,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IAEP,IAAI,CAACC,GAAG,GAAG;MACT,UAAU,EAAG,IAAI,CAACC,KAAK,GAAG,IAAIL,aAAa,CAAC,CAAE;MAC9C,YAAY,EAAG,IAAI,CAACM,MAAM,GAAG,IAAIL,cAAc,CAAC;IAClD,CAAC;EACH;EAEA,IAAIM,GAAGA,CAAA,EAAG;IACR,OAAO,2BAA2B;EACpC;EAEAC,OAAOA,CAACC,KAAK,EAAEC,OAAO,EAAE;IACtBD,KAAK,CAACE,KAAK,CAACC,OAAO,CAACC,IAAI,IAAI;MAC1B,IAAI,CAACP,MAAM,CAACE,OAAO,CAACK,IAAI,EAAEH,OAAO,CAAC;IACpC,CAAC,CAAC;EACJ;EAEAI,MAAMA,CAACC,SAAS,EAAEN,KAAK,EAAE;IACvB,IAAI,CAACA,KAAK,CAACE,KAAK,CAACK,IAAI,CAACf,cAAc,CAACgB,KAAK,CAAC,EAAE;MAC3C;IACF;IAEAF,SAAS,CAACG,QAAQ,CAAC,IAAI,CAACX,GAAG,EAAE;MAC3B,UAAU,EAAE;IACd,CAAC,CAAC;IAEFE,KAAK,CAACE,KAAK,CAACQ,MAAM,CAAClB,cAAc,CAACgB,KAAK,CAAC,CAACL,OAAO,CAACC,IAAI,IAAI,IAAI,CAACP,MAAM,CAACQ,MAAM,CAACC,SAAS,EAAEF,IAAI,CAAC,CAAC;;IAE7F;IACA,IAAI,CAACR,KAAK,CAACS,MAAM,CAACC,SAAS,EAAEN,KAAK,CAACW,GAAG,CAAC;IAEvCL,SAAS,CAACM,SAAS,CAAC,CAAC;EACvB;EAEAC,cAAcA,CAAA,EAAG;IACf,OAAO;MACLX,KAAK,EAAE;IACT,CAAC;EACH;EAEAY,aAAaA,CAACC,IAAI,EAAEC,MAAM,EAAE;IAC1B,QAAQD,IAAI;MACV,KAAK,UAAU;QACb,IAAI,CAACf,KAAK,CAACW,GAAG,GAAGK,MAAM,CAAChB,KAAK;QAC7B;MAEF,KAAK,YAAY;QACf,IAAI,CAACA,KAAK,CAACE,KAAK,CAACe,IAAI,CAACD,MAAM,CAAChB,KAAK,CAAC;QACnC;IACJ;EACF;AACF;AAEAkB,MAAM,CAACC,OAAO,GAAG1B,6BAA6B"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
