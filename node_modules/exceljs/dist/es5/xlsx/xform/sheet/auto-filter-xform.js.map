<<<<<<< HEAD
{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/auto-filter-xform.js"],"names":["colCache","require","BaseXform","AutoFilterXform","xmlStream","model","leafNode","ref","getAddress","addr","row","column","address","firstAddress","from","secondAddress","to","node","name","attributes","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,0BAAD,CAAxB;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,eAAD,CAAzB;;IAEME,e;;;;;;;;;;;;;2BAKGC,S,EAAWC,K,EAAO;AACvB,UAAIA,KAAJ,EAAW;AACT,YAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;AACAD,UAAAA,SAAS,CAACE,QAAV,CAAmB,YAAnB,EAAiC;AAACC,YAAAA,GAAG,EAAEF;AAAN,WAAjC;AACD,SAHD,MAGO;AACL,cAAMG,UAAU,GAAG,SAAbA,UAAa,CAASC,IAAT,EAAe;AAChC,gBAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5B,qBAAOA,IAAP;AACD;;AACD,mBAAOT,QAAQ,CAACQ,UAAT,CAAoBC,IAAI,CAACC,GAAzB,EAA8BD,IAAI,CAACE,MAAnC,EAA2CC,OAAlD;AACD,WALD;;AAOA,cAAMC,YAAY,GAAGL,UAAU,CAACH,KAAK,CAACS,IAAP,CAA/B;AACA,cAAMC,aAAa,GAAGP,UAAU,CAACH,KAAK,CAACW,EAAP,CAAhC;;AACA,cAAIH,YAAY,IAAIE,aAApB,EAAmC;AACjCX,YAAAA,SAAS,CAACE,QAAV,CAAmB,YAAnB,EAAiC;AAACC,cAAAA,GAAG,YAAKM,YAAL,cAAqBE,aAArB;AAAJ,aAAjC;AACD;AACF;AACF;AACF;;;8BAESE,I,EAAM;AACd,UAAIA,IAAI,CAACC,IAAL,KAAc,YAAlB,EAAgC;AAC9B,aAAKb,KAAL,GAAaY,IAAI,CAACE,UAAL,CAAgBZ,GAA7B;AACD;AACF;;;wBA9BS;AACR,aAAO,YAAP;AACD;;;;EAH2BL,S;;AAkC9BkB,MAAM,CAACC,OAAP,GAAiBlB,eAAjB","sourcesContent":["const colCache = require('../../../utils/col-cache');\r\nconst BaseXform = require('../base-xform');\r\n\r\nclass AutoFilterXform extends BaseXform {\r\n  get tag() {\r\n    return 'autoFilter';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (model) {\r\n      if (typeof model === 'string') {\r\n        // assume range\r\n        xmlStream.leafNode('autoFilter', {ref: model});\r\n      } else {\r\n        const getAddress = function(addr) {\r\n          if (typeof addr === 'string') {\r\n            return addr;\r\n          }\r\n          return colCache.getAddress(addr.row, addr.column).address;\r\n        };\r\n\r\n        const firstAddress = getAddress(model.from);\r\n        const secondAddress = getAddress(model.to);\r\n        if (firstAddress && secondAddress) {\r\n          xmlStream.leafNode('autoFilter', {ref: `${firstAddress}:${secondAddress}`});\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (node.name === 'autoFilter') {\r\n      this.model = node.attributes.ref;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = AutoFilterXform;\r\n"],"file":"auto-filter-xform.js"}
=======
{"version":3,"file":"auto-filter-xform.js","names":["colCache","require","BaseXform","AutoFilterXform","tag","render","xmlStream","model","leafNode","ref","getAddress","addr","row","column","address","firstAddress","from","secondAddress","to","parseOpen","node","name","attributes","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/auto-filter-xform.js"],"sourcesContent":["const colCache = require('../../../utils/col-cache');\nconst BaseXform = require('../base-xform');\n\nclass AutoFilterXform extends BaseXform {\n  get tag() {\n    return 'autoFilter';\n  }\n\n  render(xmlStream, model) {\n    if (model) {\n      if (typeof model === 'string') {\n        // assume range\n        xmlStream.leafNode('autoFilter', {ref: model});\n      } else {\n        const getAddress = function(addr) {\n          if (typeof addr === 'string') {\n            return addr;\n          }\n          return colCache.getAddress(addr.row, addr.column).address;\n        };\n\n        const firstAddress = getAddress(model.from);\n        const secondAddress = getAddress(model.to);\n        if (firstAddress && secondAddress) {\n          xmlStream.leafNode('autoFilter', {ref: `${firstAddress}:${secondAddress}`});\n        }\n      }\n    }\n  }\n\n  parseOpen(node) {\n    if (node.name === 'autoFilter') {\n      this.model = node.attributes.ref;\n    }\n  }\n}\n\nmodule.exports = AutoFilterXform;\n"],"mappings":";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,0BAA0B,CAAC;AACpD,MAAMC,SAAS,GAAGD,OAAO,CAAC,eAAe,CAAC;AAE1C,MAAME,eAAe,SAASD,SAAS,CAAC;EACtC,IAAIE,GAAGA,CAAA,EAAG;IACR,OAAO,YAAY;EACrB;EAEAC,MAAMA,CAACC,SAAS,EAAEC,KAAK,EAAE;IACvB,IAAIA,KAAK,EAAE;MACT,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;QAC7B;QACAD,SAAS,CAACE,QAAQ,CAAC,YAAY,EAAE;UAACC,GAAG,EAAEF;QAAK,CAAC,CAAC;MAChD,CAAC,MAAM;QACL,MAAMG,UAAU,GAAG,SAAAA,CAASC,IAAI,EAAE;UAChC,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;YAC5B,OAAOA,IAAI;UACb;UACA,OAAOX,QAAQ,CAACU,UAAU,CAACC,IAAI,CAACC,GAAG,EAAED,IAAI,CAACE,MAAM,CAAC,CAACC,OAAO;QAC3D,CAAC;QAED,MAAMC,YAAY,GAAGL,UAAU,CAACH,KAAK,CAACS,IAAI,CAAC;QAC3C,MAAMC,aAAa,GAAGP,UAAU,CAACH,KAAK,CAACW,EAAE,CAAC;QAC1C,IAAIH,YAAY,IAAIE,aAAa,EAAE;UACjCX,SAAS,CAACE,QAAQ,CAAC,YAAY,EAAE;YAACC,GAAG,EAAG,GAAEM,YAAa,IAAGE,aAAc;UAAC,CAAC,CAAC;QAC7E;MACF;IACF;EACF;EAEAE,SAASA,CAACC,IAAI,EAAE;IACd,IAAIA,IAAI,CAACC,IAAI,KAAK,YAAY,EAAE;MAC9B,IAAI,CAACd,KAAK,GAAGa,IAAI,CAACE,UAAU,CAACb,GAAG;IAClC;EACF;AACF;AAEAc,MAAM,CAACC,OAAO,GAAGrB,eAAe"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
