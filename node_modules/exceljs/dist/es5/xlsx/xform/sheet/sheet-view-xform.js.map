<<<<<<< HEAD
{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/sheet-view-xform.js"],"names":["colCache","require","BaseXform","VIEW_STATES","frozen","frozenSplit","split","SheetViewXform","model","state","xmlStream","openNode","workbookViewId","add","name","value","included","addAttribute","rightToLeft","tabSelected","showRuler","showRowColHeaders","showGridLines","zoomScale","zoomScaleNormal","style","topLeftCell","xSplit","ySplit","activePane","getAddress","address","leafNode","undefined","pane","activeCell","sqref","closeNode","node","sheetView","parseInt","attributes","view","selections","selection","topLeft","module","exports"],"mappings":"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","sourcesContent":["const colCache = require('../../../utils/col-cache');\r\nconst BaseXform = require('../base-xform');\r\n\r\nconst VIEW_STATES = {\r\n  frozen: 'frozen',\r\n  frozenSplit: 'frozen',\r\n  split: 'split',\r\n};\r\n\r\nclass SheetViewXform extends BaseXform {\r\n  get tag() {\r\n    return 'sheetView';\r\n  }\r\n\r\n  prepare(model) {\r\n    switch (model.state) {\r\n      case 'frozen':\r\n      case 'split':\r\n        break;\r\n      default:\r\n        model.state = 'normal';\r\n        break;\r\n    }\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.openNode('sheetView', {\r\n      workbookViewId: model.workbookViewId || 0,\r\n    });\r\n    const add = function(name, value, included) {\r\n      if (included) {\r\n        xmlStream.addAttribute(name, value);\r\n      }\r\n    };\r\n    add('rightToLeft', '1', model.rightToLeft === true);\r\n    add('tabSelected', '1', model.tabSelected);\r\n    add('showRuler', '0', model.showRuler === false);\r\n    add('showRowColHeaders', '0', model.showRowColHeaders === false);\r\n    add('showGridLines', '0', model.showGridLines === false);\r\n    add('zoomScale', model.zoomScale, model.zoomScale);\r\n    add('zoomScaleNormal', model.zoomScaleNormal, model.zoomScaleNormal);\r\n    add('view', model.style, model.style);\r\n\r\n    let topLeftCell;\r\n    let xSplit;\r\n    let ySplit;\r\n    let activePane;\r\n    switch (model.state) {\r\n      case 'frozen':\r\n        xSplit = model.xSplit || 0;\r\n        ySplit = model.ySplit || 0;\r\n        topLeftCell = model.topLeftCell || colCache.getAddress(ySplit + 1, xSplit + 1).address;\r\n        activePane =\r\n          (model.xSplit && model.ySplit && 'bottomRight') ||\r\n          (model.xSplit && 'topRight') ||\r\n          'bottomLeft';\r\n\r\n        xmlStream.leafNode('pane', {\r\n          xSplit: model.xSplit || undefined,\r\n          ySplit: model.ySplit || undefined,\r\n          topLeftCell,\r\n          activePane,\r\n          state: 'frozen',\r\n        });\r\n        xmlStream.leafNode('selection', {\r\n          pane: activePane,\r\n          activeCell: model.activeCell,\r\n          sqref: model.activeCell,\r\n        });\r\n        break;\r\n      case 'split':\r\n        if (model.activePane === 'topLeft') {\r\n          model.activePane = undefined;\r\n        }\r\n        xmlStream.leafNode('pane', {\r\n          xSplit: model.xSplit || undefined,\r\n          ySplit: model.ySplit || undefined,\r\n          topLeftCell: model.topLeftCell,\r\n          activePane: model.activePane,\r\n        });\r\n        xmlStream.leafNode('selection', {\r\n          pane: model.activePane,\r\n          activeCell: model.activeCell,\r\n          sqref: model.activeCell,\r\n        });\r\n        break;\r\n      case 'normal':\r\n        if (model.activeCell) {\r\n          xmlStream.leafNode('selection', {\r\n            activeCell: model.activeCell,\r\n            sqref: model.activeCell,\r\n          });\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    switch (node.name) {\r\n      case 'sheetView':\r\n        this.sheetView = {\r\n          workbookViewId: parseInt(node.attributes.workbookViewId, 10),\r\n          rightToLeft: node.attributes.rightToLeft === '1',\r\n          tabSelected: node.attributes.tabSelected === '1',\r\n          showRuler: !(node.attributes.showRuler === '0'),\r\n          showRowColHeaders: !(node.attributes.showRowColHeaders === '0'),\r\n          showGridLines: !(node.attributes.showGridLines === '0'),\r\n          zoomScale: parseInt(node.attributes.zoomScale || '100', 10),\r\n          zoomScaleNormal: parseInt(node.attributes.zoomScaleNormal || '100', 10),\r\n          style: node.attributes.view,\r\n        };\r\n        this.pane = undefined;\r\n        this.selections = {};\r\n        return true;\r\n\r\n      case 'pane':\r\n        this.pane = {\r\n          xSplit: parseInt(node.attributes.xSplit || '0', 10),\r\n          ySplit: parseInt(node.attributes.ySplit || '0', 10),\r\n          topLeftCell: node.attributes.topLeftCell,\r\n          activePane: node.attributes.activePane || 'topLeft',\r\n          state: node.attributes.state,\r\n        };\r\n        return true;\r\n\r\n      case 'selection': {\r\n        const name = node.attributes.pane || 'topLeft';\r\n        this.selections[name] = {\r\n          pane: name,\r\n          activeCell: node.attributes.activeCell,\r\n        };\r\n        return true;\r\n      }\r\n\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose(name) {\r\n    let model;\r\n    let selection;\r\n    switch (name) {\r\n      case 'sheetView':\r\n        if (this.sheetView && this.pane) {\r\n          model = this.model = {\r\n            workbookViewId: this.sheetView.workbookViewId,\r\n            rightToLeft: this.sheetView.rightToLeft,\r\n            state: VIEW_STATES[this.pane.state] || 'split', // split is default\r\n            xSplit: this.pane.xSplit,\r\n            ySplit: this.pane.ySplit,\r\n            topLeftCell: this.pane.topLeftCell,\r\n            showRuler: this.sheetView.showRuler,\r\n            showRowColHeaders: this.sheetView.showRowColHeaders,\r\n            showGridLines: this.sheetView.showGridLines,\r\n            zoomScale: this.sheetView.zoomScale,\r\n            zoomScaleNormal: this.sheetView.zoomScaleNormal,\r\n          };\r\n          if (this.model.state === 'split') {\r\n            model.activePane = this.pane.activePane;\r\n          }\r\n          selection = this.selections[this.pane.activePane];\r\n          if (selection && selection.activeCell) {\r\n            model.activeCell = selection.activeCell;\r\n          }\r\n          if (this.sheetView.style) {\r\n            model.style = this.sheetView.style;\r\n          }\r\n        } else {\r\n          model = this.model = {\r\n            workbookViewId: this.sheetView.workbookViewId,\r\n            rightToLeft: this.sheetView.rightToLeft,\r\n            state: 'normal',\r\n            showRuler: this.sheetView.showRuler,\r\n            showRowColHeaders: this.sheetView.showRowColHeaders,\r\n            showGridLines: this.sheetView.showGridLines,\r\n            zoomScale: this.sheetView.zoomScale,\r\n            zoomScaleNormal: this.sheetView.zoomScaleNormal,\r\n          };\r\n          selection = this.selections.topLeft;\r\n          if (selection && selection.activeCell) {\r\n            model.activeCell = selection.activeCell;\r\n          }\r\n          if (this.sheetView.style) {\r\n            model.style = this.sheetView.style;\r\n          }\r\n        }\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n\r\n  reconcile() {}\r\n}\r\n\r\nmodule.exports = SheetViewXform;\r\n"],"file":"sheet-view-xform.js"}
=======
{"version":3,"file":"sheet-view-xform.js","names":["colCache","require","BaseXform","VIEW_STATES","frozen","frozenSplit","split","SheetViewXform","tag","prepare","model","state","render","xmlStream","openNode","workbookViewId","add","name","value","included","addAttribute","rightToLeft","tabSelected","showRuler","showRowColHeaders","showGridLines","zoomScale","zoomScaleNormal","style","topLeftCell","xSplit","ySplit","activePane","getAddress","address","leafNode","undefined","pane","activeCell","sqref","closeNode","parseOpen","node","sheetView","parseInt","attributes","view","selections","parseText","parseClose","selection","topLeft","reconcile","module","exports"],"sources":["../../../../../lib/xlsx/xform/sheet/sheet-view-xform.js"],"sourcesContent":["const colCache = require('../../../utils/col-cache');\nconst BaseXform = require('../base-xform');\n\nconst VIEW_STATES = {\n  frozen: 'frozen',\n  frozenSplit: 'frozen',\n  split: 'split',\n};\n\nclass SheetViewXform extends BaseXform {\n  get tag() {\n    return 'sheetView';\n  }\n\n  prepare(model) {\n    switch (model.state) {\n      case 'frozen':\n      case 'split':\n        break;\n      default:\n        model.state = 'normal';\n        break;\n    }\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode('sheetView', {\n      workbookViewId: model.workbookViewId || 0,\n    });\n    const add = function(name, value, included) {\n      if (included) {\n        xmlStream.addAttribute(name, value);\n      }\n    };\n    add('rightToLeft', '1', model.rightToLeft === true);\n    add('tabSelected', '1', model.tabSelected);\n    add('showRuler', '0', model.showRuler === false);\n    add('showRowColHeaders', '0', model.showRowColHeaders === false);\n    add('showGridLines', '0', model.showGridLines === false);\n    add('zoomScale', model.zoomScale, model.zoomScale);\n    add('zoomScaleNormal', model.zoomScaleNormal, model.zoomScaleNormal);\n    add('view', model.style, model.style);\n\n    let topLeftCell;\n    let xSplit;\n    let ySplit;\n    let activePane;\n    switch (model.state) {\n      case 'frozen':\n        xSplit = model.xSplit || 0;\n        ySplit = model.ySplit || 0;\n        topLeftCell = model.topLeftCell || colCache.getAddress(ySplit + 1, xSplit + 1).address;\n        activePane =\n          (model.xSplit && model.ySplit && 'bottomRight') ||\n          (model.xSplit && 'topRight') ||\n          'bottomLeft';\n\n        xmlStream.leafNode('pane', {\n          xSplit: model.xSplit || undefined,\n          ySplit: model.ySplit || undefined,\n          topLeftCell,\n          activePane,\n          state: 'frozen',\n        });\n        xmlStream.leafNode('selection', {\n          pane: activePane,\n          activeCell: model.activeCell,\n          sqref: model.activeCell,\n        });\n        break;\n      case 'split':\n        if (model.activePane === 'topLeft') {\n          model.activePane = undefined;\n        }\n        xmlStream.leafNode('pane', {\n          xSplit: model.xSplit || undefined,\n          ySplit: model.ySplit || undefined,\n          topLeftCell: model.topLeftCell,\n          activePane: model.activePane,\n        });\n        xmlStream.leafNode('selection', {\n          pane: model.activePane,\n          activeCell: model.activeCell,\n          sqref: model.activeCell,\n        });\n        break;\n      case 'normal':\n        if (model.activeCell) {\n          xmlStream.leafNode('selection', {\n            activeCell: model.activeCell,\n            sqref: model.activeCell,\n          });\n        }\n        break;\n      default:\n        break;\n    }\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case 'sheetView':\n        this.sheetView = {\n          workbookViewId: parseInt(node.attributes.workbookViewId, 10),\n          rightToLeft: node.attributes.rightToLeft === '1',\n          tabSelected: node.attributes.tabSelected === '1',\n          showRuler: !(node.attributes.showRuler === '0'),\n          showRowColHeaders: !(node.attributes.showRowColHeaders === '0'),\n          showGridLines: !(node.attributes.showGridLines === '0'),\n          zoomScale: parseInt(node.attributes.zoomScale || '100', 10),\n          zoomScaleNormal: parseInt(node.attributes.zoomScaleNormal || '100', 10),\n          style: node.attributes.view,\n        };\n        this.pane = undefined;\n        this.selections = {};\n        return true;\n\n      case 'pane':\n        this.pane = {\n          xSplit: parseInt(node.attributes.xSplit || '0', 10),\n          ySplit: parseInt(node.attributes.ySplit || '0', 10),\n          topLeftCell: node.attributes.topLeftCell,\n          activePane: node.attributes.activePane || 'topLeft',\n          state: node.attributes.state,\n        };\n        return true;\n\n      case 'selection': {\n        const name = node.attributes.pane || 'topLeft';\n        this.selections[name] = {\n          pane: name,\n          activeCell: node.attributes.activeCell,\n        };\n        return true;\n      }\n\n      default:\n        return false;\n    }\n  }\n\n  parseText() {}\n\n  parseClose(name) {\n    let model;\n    let selection;\n    switch (name) {\n      case 'sheetView':\n        if (this.sheetView && this.pane) {\n          model = this.model = {\n            workbookViewId: this.sheetView.workbookViewId,\n            rightToLeft: this.sheetView.rightToLeft,\n            state: VIEW_STATES[this.pane.state] || 'split', // split is default\n            xSplit: this.pane.xSplit,\n            ySplit: this.pane.ySplit,\n            topLeftCell: this.pane.topLeftCell,\n            showRuler: this.sheetView.showRuler,\n            showRowColHeaders: this.sheetView.showRowColHeaders,\n            showGridLines: this.sheetView.showGridLines,\n            zoomScale: this.sheetView.zoomScale,\n            zoomScaleNormal: this.sheetView.zoomScaleNormal,\n          };\n          if (this.model.state === 'split') {\n            model.activePane = this.pane.activePane;\n          }\n          selection = this.selections[this.pane.activePane];\n          if (selection && selection.activeCell) {\n            model.activeCell = selection.activeCell;\n          }\n          if (this.sheetView.style) {\n            model.style = this.sheetView.style;\n          }\n        } else {\n          model = this.model = {\n            workbookViewId: this.sheetView.workbookViewId,\n            rightToLeft: this.sheetView.rightToLeft,\n            state: 'normal',\n            showRuler: this.sheetView.showRuler,\n            showRowColHeaders: this.sheetView.showRowColHeaders,\n            showGridLines: this.sheetView.showGridLines,\n            zoomScale: this.sheetView.zoomScale,\n            zoomScaleNormal: this.sheetView.zoomScaleNormal,\n          };\n          selection = this.selections.topLeft;\n          if (selection && selection.activeCell) {\n            model.activeCell = selection.activeCell;\n          }\n          if (this.sheetView.style) {\n            model.style = this.sheetView.style;\n          }\n        }\n        return false;\n      default:\n        return true;\n    }\n  }\n\n  reconcile() {}\n}\n\nmodule.exports = SheetViewXform;\n"],"mappings":"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"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
