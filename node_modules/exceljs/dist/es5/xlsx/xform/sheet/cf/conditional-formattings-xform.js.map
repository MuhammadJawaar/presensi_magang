<<<<<<< HEAD
{"version":3,"sources":["../../../../../../lib/xlsx/xform/sheet/cf/conditional-formattings-xform.js"],"names":["BaseXform","require","ConditionalFormattingXform","ConditionalFormattingsXform","cfXform","model","options","nextPriority","reduce","p","cf","Math","max","rules","map","rule","priority","forEach","style","dxfId","styles","addDxfStyle","xmlStream","render","node","parser","parseOpen","name","text","parseText","parseClose","push","undefined","getDxfStyle","module","exports"],"mappings":"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","sourcesContent":["const BaseXform = require('../../base-xform');\r\n\r\nconst ConditionalFormattingXform = require('./conditional-formatting-xform');\r\n\r\nclass ConditionalFormattingsXform extends BaseXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.cfXform = new ConditionalFormattingXform();\r\n  }\r\n\r\n  get tag() {\r\n    return 'conditionalFormatting';\r\n  }\r\n\r\n  reset() {\r\n    this.model = [];\r\n  }\r\n\r\n  prepare(model, options) {\r\n    // ensure each rule has a priority value\r\n    let nextPriority = model.reduce(\r\n      (p, cf) => Math.max(p, ...cf.rules.map(rule => rule.priority || 0)),\r\n      1\r\n    );\r\n    model.forEach(cf => {\r\n      cf.rules.forEach(rule => {\r\n        if (!rule.priority) {\r\n          rule.priority = nextPriority++;\r\n        }\r\n\r\n        if (rule.style) {\r\n          rule.dxfId = options.styles.addDxfStyle(rule.style);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    model.forEach(cf => {\r\n      this.cfXform.render(xmlStream, cf);\r\n    });\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n\r\n    switch (node.name) {\r\n      case 'conditionalFormatting':\r\n        this.parser = this.cfXform;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.model.push(this.parser.model);\r\n        this.parser = undefined;\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  reconcile(model, options) {\r\n    model.forEach(cf => {\r\n      cf.rules.forEach(rule => {\r\n        if (rule.dxfId !== undefined) {\r\n          rule.style = options.styles.getDxfStyle(rule.dxfId);\r\n          delete rule.dxfId;\r\n        }\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nmodule.exports = ConditionalFormattingsXform;\r\n"],"file":"conditional-formattings-xform.js"}
=======
{"version":3,"file":"conditional-formattings-xform.js","names":["BaseXform","require","ConditionalFormattingXform","ConditionalFormattingsXform","constructor","cfXform","tag","reset","model","prepare","options","nextPriority","reduce","p","cf","Math","max","rules","map","rule","priority","forEach","style","dxfId","styles","addDxfStyle","render","xmlStream","parseOpen","node","parser","name","parseText","text","parseClose","push","undefined","reconcile","getDxfStyle","module","exports"],"sources":["../../../../../../lib/xlsx/xform/sheet/cf/conditional-formattings-xform.js"],"sourcesContent":["const BaseXform = require('../../base-xform');\n\nconst ConditionalFormattingXform = require('./conditional-formatting-xform');\n\nclass ConditionalFormattingsXform extends BaseXform {\n  constructor() {\n    super();\n\n    this.cfXform = new ConditionalFormattingXform();\n  }\n\n  get tag() {\n    return 'conditionalFormatting';\n  }\n\n  reset() {\n    this.model = [];\n  }\n\n  prepare(model, options) {\n    // ensure each rule has a priority value\n    let nextPriority = model.reduce(\n      (p, cf) => Math.max(p, ...cf.rules.map(rule => rule.priority || 0)),\n      1\n    );\n    model.forEach(cf => {\n      cf.rules.forEach(rule => {\n        if (!rule.priority) {\n          rule.priority = nextPriority++;\n        }\n\n        if (rule.style) {\n          rule.dxfId = options.styles.addDxfStyle(rule.style);\n        }\n      });\n    });\n  }\n\n  render(xmlStream, model) {\n    model.forEach(cf => {\n      this.cfXform.render(xmlStream, cf);\n    });\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n\n    switch (node.name) {\n      case 'conditionalFormatting':\n        this.parser = this.cfXform;\n        this.parser.parseOpen(node);\n        return true;\n\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        this.model.push(this.parser.model);\n        this.parser = undefined;\n        return false;\n      }\n      return true;\n    }\n    return false;\n  }\n\n  reconcile(model, options) {\n    model.forEach(cf => {\n      cf.rules.forEach(rule => {\n        if (rule.dxfId !== undefined) {\n          rule.style = options.styles.getDxfStyle(rule.dxfId);\n          delete rule.dxfId;\n        }\n      });\n    });\n  }\n}\n\nmodule.exports = ConditionalFormattingsXform;\n"],"mappings":"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"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
