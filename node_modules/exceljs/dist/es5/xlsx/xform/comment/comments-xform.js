"use strict";

<<<<<<< HEAD
var XmlStream = require('../../../utils/xml-stream');

var utils = require('../../../utils/utils');

var BaseXform = require('../base-xform');

var CommentXform = require('./comment-xform');

var CommentsXform = module.exports = function () {
=======
const XmlStream = require('../../../utils/xml-stream');
const utils = require('../../../utils/utils');
const BaseXform = require('../base-xform');
const CommentXform = require('./comment-xform');
const CommentsXform = module.exports = function () {
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
  this.map = {
    comment: new CommentXform()
  };
};
<<<<<<< HEAD

=======
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
utils.inherits(CommentsXform, BaseXform, {
  COMMENTS_ATTRIBUTES: {
    xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main'
  }
}, {
<<<<<<< HEAD
  render: function render(xmlStream, model) {
    var _this = this;

    model = model || this.model;
    xmlStream.openXml(XmlStream.StdDocAttributes);
    xmlStream.openNode('comments', CommentsXform.COMMENTS_ATTRIBUTES); // authors
    // TODO: support authors properly

    xmlStream.openNode('authors');
    xmlStream.leafNode('author', null, 'Author');
    xmlStream.closeNode(); // comments

    xmlStream.openNode('commentList');
    model.comments.forEach(function (comment) {
      _this.map.comment.render(xmlStream, comment);
=======
  render(xmlStream, model) {
    model = model || this.model;
    xmlStream.openXml(XmlStream.StdDocAttributes);
    xmlStream.openNode('comments', CommentsXform.COMMENTS_ATTRIBUTES);

    // authors
    // TODO: support authors properly
    xmlStream.openNode('authors');
    xmlStream.leafNode('author', null, 'Author');
    xmlStream.closeNode();

    // comments
    xmlStream.openNode('commentList');
    model.comments.forEach(comment => {
      this.map.comment.render(xmlStream, comment);
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
    });
    xmlStream.closeNode();
    xmlStream.closeNode();
  },
<<<<<<< HEAD
  parseOpen: function parseOpen(node) {
=======
  parseOpen(node) {
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
    if (this.parser) {
      this.parser.parseOpen(node);
      return true;
    }
<<<<<<< HEAD

=======
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
    switch (node.name) {
      case 'commentList':
        this.model = {
          comments: []
        };
        return true;
<<<<<<< HEAD

=======
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
      case 'comment':
        this.parser = this.map.comment;
        this.parser.parseOpen(node);
        return true;
<<<<<<< HEAD

=======
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
      default:
        return false;
    }
  },
<<<<<<< HEAD
  parseText: function parseText(text) {
=======
  parseText(text) {
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
    if (this.parser) {
      this.parser.parseText(text);
    }
  },
<<<<<<< HEAD
  parseClose: function parseClose(name) {
    switch (name) {
      case 'commentList':
        return false;

=======
  parseClose(name) {
    switch (name) {
      case 'commentList':
        return false;
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
      case 'comment':
        this.model.comments.push(this.parser.model);
        this.parser = undefined;
        return true;
<<<<<<< HEAD

=======
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
      default:
        if (this.parser) {
          this.parser.parseClose(name);
        }
<<<<<<< HEAD

=======
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
        return true;
    }
  }
});
//# sourceMappingURL=comments-xform.js.map
