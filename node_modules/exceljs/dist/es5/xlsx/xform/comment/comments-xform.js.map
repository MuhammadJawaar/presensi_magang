<<<<<<< HEAD
{"version":3,"sources":["../../../../../lib/xlsx/xform/comment/comments-xform.js"],"names":["XmlStream","require","utils","BaseXform","CommentXform","CommentsXform","module","exports","map","comment","inherits","COMMENTS_ATTRIBUTES","xmlns","render","xmlStream","model","openXml","StdDocAttributes","openNode","leafNode","closeNode","comments","forEach","parseOpen","node","parser","name","parseText","text","parseClose","push","undefined"],"mappings":";;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,2BAAD,CAAzB;;AACA,IAAMC,KAAK,GAAGD,OAAO,CAAC,sBAAD,CAArB;;AACA,IAAME,SAAS,GAAGF,OAAO,CAAC,eAAD,CAAzB;;AAEA,IAAMG,YAAY,GAAGH,OAAO,CAAC,iBAAD,CAA5B;;AAEA,IAAMI,aAAa,GAAIC,MAAM,CAACC,OAAP,GAAiB,YAAW;AACjD,OAAKC,GAAL,GAAW;AACTC,IAAAA,OAAO,EAAE,IAAIL,YAAJ;AADA,GAAX;AAGD,CAJD;;AAMAF,KAAK,CAACQ,QAAN,CACEL,aADF,EAEEF,SAFF,EAGE;AACEQ,EAAAA,mBAAmB,EAAE;AACnBC,IAAAA,KAAK,EAAE;AADY;AADvB,CAHF,EAQE;AACEC,EAAAA,MADF,kBACSC,SADT,EACoBC,KADpB,EAC2B;AAAA;;AACvBA,IAAAA,KAAK,GAAGA,KAAK,IAAI,KAAKA,KAAtB;AACAD,IAAAA,SAAS,CAACE,OAAV,CAAkBhB,SAAS,CAACiB,gBAA5B;AACAH,IAAAA,SAAS,CAACI,QAAV,CAAmB,UAAnB,EAA+Bb,aAAa,CAACM,mBAA7C,EAHuB,CAKvB;AACA;;AACAG,IAAAA,SAAS,CAACI,QAAV,CAAmB,SAAnB;AACAJ,IAAAA,SAAS,CAACK,QAAV,CAAmB,QAAnB,EAA6B,IAA7B,EAAmC,QAAnC;AACAL,IAAAA,SAAS,CAACM,SAAV,GATuB,CAWvB;;AACAN,IAAAA,SAAS,CAACI,QAAV,CAAmB,aAAnB;AACAH,IAAAA,KAAK,CAACM,QAAN,CAAeC,OAAf,CAAuB,UAAAb,OAAO,EAAI;AAChC,MAAA,KAAI,CAACD,GAAL,CAASC,OAAT,CAAiBI,MAAjB,CAAwBC,SAAxB,EAAmCL,OAAnC;AACD,KAFD;AAGAK,IAAAA,SAAS,CAACM,SAAV;AACAN,IAAAA,SAAS,CAACM,SAAV;AACD,GAnBH;AAqBEG,EAAAA,SArBF,qBAqBYC,IArBZ,EAqBkB;AACd,QAAI,KAAKC,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACA,aAAO,IAAP;AACD;;AACD,YAAQA,IAAI,CAACE,IAAb;AACE,WAAK,aAAL;AACE,aAAKX,KAAL,GAAa;AACXM,UAAAA,QAAQ,EAAE;AADC,SAAb;AAGA,eAAO,IAAP;;AACF,WAAK,SAAL;AACE,aAAKI,MAAL,GAAc,KAAKjB,GAAL,CAASC,OAAvB;AACA,aAAKgB,MAAL,CAAYF,SAAZ,CAAsBC,IAAtB;AACA,eAAO,IAAP;;AACF;AACE,eAAO,KAAP;AAXJ;AAaD,GAvCH;AAwCEG,EAAAA,SAxCF,qBAwCYC,IAxCZ,EAwCkB;AACd,QAAI,KAAKH,MAAT,EAAiB;AACf,WAAKA,MAAL,CAAYE,SAAZ,CAAsBC,IAAtB;AACD;AACF,GA5CH;AA6CEC,EAAAA,UA7CF,sBA6CaH,IA7Cb,EA6CmB;AACf,YAAQA,IAAR;AACE,WAAK,aAAL;AACE,eAAO,KAAP;;AACF,WAAK,SAAL;AACE,aAAKX,KAAL,CAAWM,QAAX,CAAoBS,IAApB,CAAyB,KAAKL,MAAL,CAAYV,KAArC;AACA,aAAKU,MAAL,GAAcM,SAAd;AACA,eAAO,IAAP;;AACF;AACE,YAAI,KAAKN,MAAT,EAAiB;AACf,eAAKA,MAAL,CAAYI,UAAZ,CAAuBH,IAAvB;AACD;;AACD,eAAO,IAAP;AAXJ;AAaD;AA3DH,CARF","sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\r\nconst utils = require('../../../utils/utils');\r\nconst BaseXform = require('../base-xform');\r\n\r\nconst CommentXform = require('./comment-xform');\r\n\r\nconst CommentsXform = (module.exports = function() {\r\n  this.map = {\r\n    comment: new CommentXform(),\r\n  };\r\n});\r\n\r\nutils.inherits(\r\n  CommentsXform,\r\n  BaseXform,\r\n  {\r\n    COMMENTS_ATTRIBUTES: {\r\n      xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\r\n    },\r\n  },\r\n  {\r\n    render(xmlStream, model) {\r\n      model = model || this.model;\r\n      xmlStream.openXml(XmlStream.StdDocAttributes);\r\n      xmlStream.openNode('comments', CommentsXform.COMMENTS_ATTRIBUTES);\r\n\r\n      // authors\r\n      // TODO: support authors properly\r\n      xmlStream.openNode('authors');\r\n      xmlStream.leafNode('author', null, 'Author');\r\n      xmlStream.closeNode();\r\n\r\n      // comments\r\n      xmlStream.openNode('commentList');\r\n      model.comments.forEach(comment => {\r\n        this.map.comment.render(xmlStream, comment);\r\n      });\r\n      xmlStream.closeNode();\r\n      xmlStream.closeNode();\r\n    },\r\n\r\n    parseOpen(node) {\r\n      if (this.parser) {\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      }\r\n      switch (node.name) {\r\n        case 'commentList':\r\n          this.model = {\r\n            comments: [],\r\n          };\r\n          return true;\r\n        case 'comment':\r\n          this.parser = this.map.comment;\r\n          this.parser.parseOpen(node);\r\n          return true;\r\n        default:\r\n          return false;\r\n      }\r\n    },\r\n    parseText(text) {\r\n      if (this.parser) {\r\n        this.parser.parseText(text);\r\n      }\r\n    },\r\n    parseClose(name) {\r\n      switch (name) {\r\n        case 'commentList':\r\n          return false;\r\n        case 'comment':\r\n          this.model.comments.push(this.parser.model);\r\n          this.parser = undefined;\r\n          return true;\r\n        default:\r\n          if (this.parser) {\r\n            this.parser.parseClose(name);\r\n          }\r\n          return true;\r\n      }\r\n    },\r\n  }\r\n);\r\n"],"file":"comments-xform.js"}
=======
{"version":3,"file":"comments-xform.js","names":["XmlStream","require","utils","BaseXform","CommentXform","CommentsXform","module","exports","map","comment","inherits","COMMENTS_ATTRIBUTES","xmlns","render","xmlStream","model","openXml","StdDocAttributes","openNode","leafNode","closeNode","comments","forEach","parseOpen","node","parser","name","parseText","text","parseClose","push","undefined"],"sources":["../../../../../lib/xlsx/xform/comment/comments-xform.js"],"sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\nconst utils = require('../../../utils/utils');\nconst BaseXform = require('../base-xform');\n\nconst CommentXform = require('./comment-xform');\n\nconst CommentsXform = (module.exports = function() {\n  this.map = {\n    comment: new CommentXform(),\n  };\n});\n\nutils.inherits(\n  CommentsXform,\n  BaseXform,\n  {\n    COMMENTS_ATTRIBUTES: {\n      xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n    },\n  },\n  {\n    render(xmlStream, model) {\n      model = model || this.model;\n      xmlStream.openXml(XmlStream.StdDocAttributes);\n      xmlStream.openNode('comments', CommentsXform.COMMENTS_ATTRIBUTES);\n\n      // authors\n      // TODO: support authors properly\n      xmlStream.openNode('authors');\n      xmlStream.leafNode('author', null, 'Author');\n      xmlStream.closeNode();\n\n      // comments\n      xmlStream.openNode('commentList');\n      model.comments.forEach(comment => {\n        this.map.comment.render(xmlStream, comment);\n      });\n      xmlStream.closeNode();\n      xmlStream.closeNode();\n    },\n\n    parseOpen(node) {\n      if (this.parser) {\n        this.parser.parseOpen(node);\n        return true;\n      }\n      switch (node.name) {\n        case 'commentList':\n          this.model = {\n            comments: [],\n          };\n          return true;\n        case 'comment':\n          this.parser = this.map.comment;\n          this.parser.parseOpen(node);\n          return true;\n        default:\n          return false;\n      }\n    },\n    parseText(text) {\n      if (this.parser) {\n        this.parser.parseText(text);\n      }\n    },\n    parseClose(name) {\n      switch (name) {\n        case 'commentList':\n          return false;\n        case 'comment':\n          this.model.comments.push(this.parser.model);\n          this.parser = undefined;\n          return true;\n        default:\n          if (this.parser) {\n            this.parser.parseClose(name);\n          }\n          return true;\n      }\n    },\n  }\n);\n"],"mappings":";;AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,2BAA2B,CAAC;AACtD,MAAMC,KAAK,GAAGD,OAAO,CAAC,sBAAsB,CAAC;AAC7C,MAAME,SAAS,GAAGF,OAAO,CAAC,eAAe,CAAC;AAE1C,MAAMG,YAAY,GAAGH,OAAO,CAAC,iBAAiB,CAAC;AAE/C,MAAMI,aAAa,GAAIC,MAAM,CAACC,OAAO,GAAG,YAAW;EACjD,IAAI,CAACC,GAAG,GAAG;IACTC,OAAO,EAAE,IAAIL,YAAY,CAAC;EAC5B,CAAC;AACH,CAAE;AAEFF,KAAK,CAACQ,QAAQ,CACZL,aAAa,EACbF,SAAS,EACT;EACEQ,mBAAmB,EAAE;IACnBC,KAAK,EAAE;EACT;AACF,CAAC,EACD;EACEC,MAAMA,CAACC,SAAS,EAAEC,KAAK,EAAE;IACvBA,KAAK,GAAGA,KAAK,IAAI,IAAI,CAACA,KAAK;IAC3BD,SAAS,CAACE,OAAO,CAAChB,SAAS,CAACiB,gBAAgB,CAAC;IAC7CH,SAAS,CAACI,QAAQ,CAAC,UAAU,EAAEb,aAAa,CAACM,mBAAmB,CAAC;;IAEjE;IACA;IACAG,SAAS,CAACI,QAAQ,CAAC,SAAS,CAAC;IAC7BJ,SAAS,CAACK,QAAQ,CAAC,QAAQ,EAAE,IAAI,EAAE,QAAQ,CAAC;IAC5CL,SAAS,CAACM,SAAS,CAAC,CAAC;;IAErB;IACAN,SAAS,CAACI,QAAQ,CAAC,aAAa,CAAC;IACjCH,KAAK,CAACM,QAAQ,CAACC,OAAO,CAACb,OAAO,IAAI;MAChC,IAAI,CAACD,GAAG,CAACC,OAAO,CAACI,MAAM,CAACC,SAAS,EAAEL,OAAO,CAAC;IAC7C,CAAC,CAAC;IACFK,SAAS,CAACM,SAAS,CAAC,CAAC;IACrBN,SAAS,CAACM,SAAS,CAAC,CAAC;EACvB,CAAC;EAEDG,SAASA,CAACC,IAAI,EAAE;IACd,IAAI,IAAI,CAACC,MAAM,EAAE;MACf,IAAI,CAACA,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;MAC3B,OAAO,IAAI;IACb;IACA,QAAQA,IAAI,CAACE,IAAI;MACf,KAAK,aAAa;QAChB,IAAI,CAACX,KAAK,GAAG;UACXM,QAAQ,EAAE;QACZ,CAAC;QACD,OAAO,IAAI;MACb,KAAK,SAAS;QACZ,IAAI,CAACI,MAAM,GAAG,IAAI,CAACjB,GAAG,CAACC,OAAO;QAC9B,IAAI,CAACgB,MAAM,CAACF,SAAS,CAACC,IAAI,CAAC;QAC3B,OAAO,IAAI;MACb;QACE,OAAO,KAAK;IAChB;EACF,CAAC;EACDG,SAASA,CAACC,IAAI,EAAE;IACd,IAAI,IAAI,CAACH,MAAM,EAAE;MACf,IAAI,CAACA,MAAM,CAACE,SAAS,CAACC,IAAI,CAAC;IAC7B;EACF,CAAC;EACDC,UAAUA,CAACH,IAAI,EAAE;IACf,QAAQA,IAAI;MACV,KAAK,aAAa;QAChB,OAAO,KAAK;MACd,KAAK,SAAS;QACZ,IAAI,CAACX,KAAK,CAACM,QAAQ,CAACS,IAAI,CAAC,IAAI,CAACL,MAAM,CAACV,KAAK,CAAC;QAC3C,IAAI,CAACU,MAAM,GAAGM,SAAS;QACvB,OAAO,IAAI;MACb;QACE,IAAI,IAAI,CAACN,MAAM,EAAE;UACf,IAAI,CAACA,MAAM,CAACI,UAAU,CAACH,IAAI,CAAC;QAC9B;QACA,OAAO,IAAI;IACf;EACF;AACF,CACF,CAAC"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
