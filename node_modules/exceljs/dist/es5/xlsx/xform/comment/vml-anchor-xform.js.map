<<<<<<< HEAD
{"version":3,"sources":["../../../../../lib/xlsx/xform/comment/vml-anchor-xform.js"],"names":["BaseXform","require","VmlAnchorXform","anchor","l","Math","floor","left","lf","t","top","tf","r","right","rf","b","bottom","bf","ref","col","max","row","xmlStream","model","rect","getAnchorRect","getDefaultRect","refAddress","leafNode","join","node","name","tag","text","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB,C,CAEA;;;IACMC,c;;;;;;;;;;;;;kCAKUC,M,EAAQ;AACpB,UAAMC,CAAC,GAAGC,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACI,IAAlB,CAAV;AACA,UAAMC,EAAE,GAAGH,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACI,IAAP,GAAcH,CAAf,IAAoB,EAA/B,CAAX;AACA,UAAMK,CAAC,GAAGJ,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACO,GAAlB,CAAV;AACA,UAAMC,EAAE,GAAGN,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACO,GAAP,GAAaD,CAAd,IAAmB,EAA9B,CAAX;AACA,UAAMG,CAAC,GAAGP,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACU,KAAlB,CAAV;AACA,UAAMC,EAAE,GAAGT,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACU,KAAP,GAAeD,CAAhB,IAAqB,EAAhC,CAAX;AACA,UAAMG,CAAC,GAAGV,IAAI,CAACC,KAAL,CAAWH,MAAM,CAACa,MAAlB,CAAV;AACA,UAAMC,EAAE,GAAGZ,IAAI,CAACC,KAAL,CAAW,CAACH,MAAM,CAACa,MAAP,GAAgBD,CAAjB,IAAsB,EAAjC,CAAX;AACA,aAAO,CAACX,CAAD,EAAII,EAAJ,EAAQC,CAAR,EAAWE,EAAX,EAAeC,CAAf,EAAkBE,EAAlB,EAAsBC,CAAtB,EAAyBE,EAAzB,CAAP;AACD;;;mCAEcC,G,EAAK;AAClB,UAAMd,CAAC,GAAGc,GAAG,CAACC,GAAd;AACA,UAAMX,EAAE,GAAG,CAAX;AACA,UAAMC,CAAC,GAAGJ,IAAI,CAACe,GAAL,CAASF,GAAG,CAACG,GAAJ,GAAU,CAAnB,EAAsB,CAAtB,CAAV;AACA,UAAMV,EAAE,GAAG,EAAX;AACA,UAAMC,CAAC,GAAGR,CAAC,GAAG,CAAd;AACA,UAAMU,EAAE,GAAG,CAAX;AACA,UAAMC,CAAC,GAAGN,CAAC,GAAG,CAAd;AACA,UAAMQ,EAAE,GAAG,EAAX;AACA,aAAO,CAACb,CAAD,EAAII,EAAJ,EAAQC,CAAR,EAAWE,EAAX,EAAeC,CAAf,EAAkBE,EAAlB,EAAsBC,CAAtB,EAAyBE,EAAzB,CAAP;AACD;;;2BAEMK,S,EAAWC,K,EAAO;AACvB,UAAMC,IAAI,GAAGD,KAAK,CAACpB,MAAN,GACT,KAAKsB,aAAL,CAAmBF,KAAK,CAACpB,MAAzB,CADS,GAET,KAAKuB,cAAL,CAAoBH,KAAK,CAACI,UAA1B,CAFJ;AAIAL,MAAAA,SAAS,CAACM,QAAV,CAAmB,UAAnB,EAA+B,IAA/B,EAAqCJ,IAAI,CAACK,IAAL,CAAU,IAAV,CAArC;AACD;;;8BAESC,I,EAAM;AACd,cAAQA,IAAI,CAACC,IAAb;AACE,aAAK,KAAKC,GAAV;AACE,eAAKC,IAAL,GAAY,EAAZ;AACA,iBAAO,IAAP;;AACF;AACE,iBAAO,KAAP;AALJ;AAOD;;;8BAESA,I,EAAM;AACd,WAAKA,IAAL,GAAYA,IAAZ;AACD;;;iCAEY;AACX,aAAO,KAAP;AACD;;;wBApDS;AACR,aAAO,UAAP;AACD;;;;EAH0BjC,S;;AAwD7BkC,MAAM,CAACC,OAAP,GAAiBjC,cAAjB","sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\n// render the triangle in the cell for the comment\r\nclass VmlAnchorXform extends BaseXform {\r\n  get tag() {\r\n    return 'x:Anchor';\r\n  }\r\n\r\n  getAnchorRect(anchor) {\r\n    const l = Math.floor(anchor.left);\r\n    const lf = Math.floor((anchor.left - l) * 68);\r\n    const t = Math.floor(anchor.top);\r\n    const tf = Math.floor((anchor.top - t) * 18);\r\n    const r = Math.floor(anchor.right);\r\n    const rf = Math.floor((anchor.right - r) * 68);\r\n    const b = Math.floor(anchor.bottom);\r\n    const bf = Math.floor((anchor.bottom - b) * 18);\r\n    return [l, lf, t, tf, r, rf, b, bf];\r\n  }\r\n\r\n  getDefaultRect(ref) {\r\n    const l = ref.col;\r\n    const lf = 6;\r\n    const t = Math.max(ref.row - 2, 0);\r\n    const tf = 14;\r\n    const r = l + 2;\r\n    const rf = 2;\r\n    const b = t + 4;\r\n    const bf = 16;\r\n    return [l, lf, t, tf, r, rf, b, bf];\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    const rect = model.anchor\r\n      ? this.getAnchorRect(model.anchor)\r\n      : this.getDefaultRect(model.refAddress);\r\n\r\n    xmlStream.leafNode('x:Anchor', null, rect.join(', '));\r\n  }\r\n\r\n  parseOpen(node) {\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.text = '';\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    this.text = text;\r\n  }\r\n\r\n  parseClose() {\r\n    return false;\r\n  }\r\n}\r\n\r\nmodule.exports = VmlAnchorXform;\r\n"],"file":"vml-anchor-xform.js"}
=======
{"version":3,"file":"vml-anchor-xform.js","names":["BaseXform","require","VmlAnchorXform","tag","getAnchorRect","anchor","l","Math","floor","left","lf","t","top","tf","r","right","rf","b","bottom","bf","getDefaultRect","ref","col","max","row","render","xmlStream","model","rect","refAddress","leafNode","join","parseOpen","node","name","text","parseText","parseClose","module","exports"],"sources":["../../../../../lib/xlsx/xform/comment/vml-anchor-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\n// render the triangle in the cell for the comment\nclass VmlAnchorXform extends BaseXform {\n  get tag() {\n    return 'x:Anchor';\n  }\n\n  getAnchorRect(anchor) {\n    const l = Math.floor(anchor.left);\n    const lf = Math.floor((anchor.left - l) * 68);\n    const t = Math.floor(anchor.top);\n    const tf = Math.floor((anchor.top - t) * 18);\n    const r = Math.floor(anchor.right);\n    const rf = Math.floor((anchor.right - r) * 68);\n    const b = Math.floor(anchor.bottom);\n    const bf = Math.floor((anchor.bottom - b) * 18);\n    return [l, lf, t, tf, r, rf, b, bf];\n  }\n\n  getDefaultRect(ref) {\n    const l = ref.col;\n    const lf = 6;\n    const t = Math.max(ref.row - 2, 0);\n    const tf = 14;\n    const r = l + 2;\n    const rf = 2;\n    const b = t + 4;\n    const bf = 16;\n    return [l, lf, t, tf, r, rf, b, bf];\n  }\n\n  render(xmlStream, model) {\n    const rect = model.anchor\n      ? this.getAnchorRect(model.anchor)\n      : this.getDefaultRect(model.refAddress);\n\n    xmlStream.leafNode('x:Anchor', null, rect.join(', '));\n  }\n\n  parseOpen(node) {\n    switch (node.name) {\n      case this.tag:\n        this.text = '';\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    this.text = text;\n  }\n\n  parseClose() {\n    return false;\n  }\n}\n\nmodule.exports = VmlAnchorXform;\n"],"mappings":";;AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,eAAe,CAAC;;AAE1C;AACA,MAAMC,cAAc,SAASF,SAAS,CAAC;EACrC,IAAIG,GAAGA,CAAA,EAAG;IACR,OAAO,UAAU;EACnB;EAEAC,aAAaA,CAACC,MAAM,EAAE;IACpB,MAAMC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACH,MAAM,CAACI,IAAI,CAAC;IACjC,MAAMC,EAAE,GAAGH,IAAI,CAACC,KAAK,CAAC,CAACH,MAAM,CAACI,IAAI,GAAGH,CAAC,IAAI,EAAE,CAAC;IAC7C,MAAMK,CAAC,GAAGJ,IAAI,CAACC,KAAK,CAACH,MAAM,CAACO,GAAG,CAAC;IAChC,MAAMC,EAAE,GAAGN,IAAI,CAACC,KAAK,CAAC,CAACH,MAAM,CAACO,GAAG,GAAGD,CAAC,IAAI,EAAE,CAAC;IAC5C,MAAMG,CAAC,GAAGP,IAAI,CAACC,KAAK,CAACH,MAAM,CAACU,KAAK,CAAC;IAClC,MAAMC,EAAE,GAAGT,IAAI,CAACC,KAAK,CAAC,CAACH,MAAM,CAACU,KAAK,GAAGD,CAAC,IAAI,EAAE,CAAC;IAC9C,MAAMG,CAAC,GAAGV,IAAI,CAACC,KAAK,CAACH,MAAM,CAACa,MAAM,CAAC;IACnC,MAAMC,EAAE,GAAGZ,IAAI,CAACC,KAAK,CAAC,CAACH,MAAM,CAACa,MAAM,GAAGD,CAAC,IAAI,EAAE,CAAC;IAC/C,OAAO,CAACX,CAAC,EAAEI,EAAE,EAAEC,CAAC,EAAEE,EAAE,EAAEC,CAAC,EAAEE,EAAE,EAAEC,CAAC,EAAEE,EAAE,CAAC;EACrC;EAEAC,cAAcA,CAACC,GAAG,EAAE;IAClB,MAAMf,CAAC,GAAGe,GAAG,CAACC,GAAG;IACjB,MAAMZ,EAAE,GAAG,CAAC;IACZ,MAAMC,CAAC,GAAGJ,IAAI,CAACgB,GAAG,CAACF,GAAG,CAACG,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC;IAClC,MAAMX,EAAE,GAAG,EAAE;IACb,MAAMC,CAAC,GAAGR,CAAC,GAAG,CAAC;IACf,MAAMU,EAAE,GAAG,CAAC;IACZ,MAAMC,CAAC,GAAGN,CAAC,GAAG,CAAC;IACf,MAAMQ,EAAE,GAAG,EAAE;IACb,OAAO,CAACb,CAAC,EAAEI,EAAE,EAAEC,CAAC,EAAEE,EAAE,EAAEC,CAAC,EAAEE,EAAE,EAAEC,CAAC,EAAEE,EAAE,CAAC;EACrC;EAEAM,MAAMA,CAACC,SAAS,EAAEC,KAAK,EAAE;IACvB,MAAMC,IAAI,GAAGD,KAAK,CAACtB,MAAM,GACrB,IAAI,CAACD,aAAa,CAACuB,KAAK,CAACtB,MAAM,CAAC,GAChC,IAAI,CAACe,cAAc,CAACO,KAAK,CAACE,UAAU,CAAC;IAEzCH,SAAS,CAACI,QAAQ,CAAC,UAAU,EAAE,IAAI,EAAEF,IAAI,CAACG,IAAI,CAAC,IAAI,CAAC,CAAC;EACvD;EAEAC,SAASA,CAACC,IAAI,EAAE;IACd,QAAQA,IAAI,CAACC,IAAI;MACf,KAAK,IAAI,CAAC/B,GAAG;QACX,IAAI,CAACgC,IAAI,GAAG,EAAE;QACd,OAAO,IAAI;MACb;QACE,OAAO,KAAK;IAChB;EACF;EAEAC,SAASA,CAACD,IAAI,EAAE;IACd,IAAI,CAACA,IAAI,GAAGA,IAAI;EAClB;EAEAE,UAAUA,CAAA,EAAG;IACX,OAAO,KAAK;EACd;AACF;AAEAC,MAAM,CAACC,OAAO,GAAGrC,cAAc"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
