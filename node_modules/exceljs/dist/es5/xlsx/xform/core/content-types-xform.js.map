<<<<<<< HEAD
{"version":3,"sources":["../../../../../lib/xlsx/xform/core/content-types-xform.js"],"names":["XmlStream","require","BaseXform","ContentTypesXform","xmlStream","model","openXml","StdDocAttributes","openNode","PROPERTY_ATTRIBUTES","mediaHash","media","forEach","medium","type","imageType","extension","leafNode","Extension","ContentType","PartName","worksheets","worksheet","name","id","hasSharedStrings","sharedStrings","count","tables","table","target","drawings","drawing","commentRefs","commentName","closeNode","xmlns","module","exports"],"mappings":"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","sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\r\n\r\nconst BaseXform = require('../base-xform');\r\n\r\n// used for rendering the [Content_Types].xml file\r\n// not used for parsing\r\nclass ContentTypesXform extends BaseXform {\r\n  render(xmlStream, model) {\r\n    xmlStream.openXml(XmlStream.StdDocAttributes);\r\n\r\n    xmlStream.openNode('Types', ContentTypesXform.PROPERTY_ATTRIBUTES);\r\n\r\n    const mediaHash = {};\r\n    (model.media || []).forEach(medium => {\r\n      if (medium.type === 'image') {\r\n        const imageType = medium.extension;\r\n        if (!mediaHash[imageType]) {\r\n          mediaHash[imageType] = true;\r\n          xmlStream.leafNode('Default', {Extension: imageType, ContentType: `image/${imageType}`});\r\n        }\r\n      }\r\n    });\r\n\r\n    xmlStream.leafNode('Default', {\r\n      Extension: 'rels',\r\n      ContentType: 'application/vnd.openxmlformats-package.relationships+xml',\r\n    });\r\n    xmlStream.leafNode('Default', {Extension: 'xml', ContentType: 'application/xml'});\r\n\r\n    xmlStream.leafNode('Override', {\r\n      PartName: '/xl/workbook.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml',\r\n    });\r\n\r\n    model.worksheets.forEach(worksheet => {\r\n      const name = `/xl/worksheets/sheet${worksheet.id}.xml`;\r\n      xmlStream.leafNode('Override', {\r\n        PartName: name,\r\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml',\r\n      });\r\n    });\r\n\r\n    xmlStream.leafNode('Override', {\r\n      PartName: '/xl/theme/theme1.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.theme+xml',\r\n    });\r\n    xmlStream.leafNode('Override', {\r\n      PartName: '/xl/styles.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml',\r\n    });\r\n\r\n    const hasSharedStrings = model.sharedStrings && model.sharedStrings.count;\r\n    if (hasSharedStrings) {\r\n      xmlStream.leafNode('Override', {\r\n        PartName: '/xl/sharedStrings.xml',\r\n        ContentType:\r\n          'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml',\r\n      });\r\n    }\r\n\r\n    if (model.tables) {\r\n      model.tables.forEach(table => {\r\n        xmlStream.leafNode('Override', {\r\n          PartName: `/xl/tables/${table.target}`,\r\n          ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml',\r\n        });\r\n      });\r\n    }\r\n\r\n    if (model.drawings) {\r\n      model.drawings.forEach(drawing => {\r\n        xmlStream.leafNode('Override', {\r\n          PartName: `/xl/drawings/${drawing.name}.xml`,\r\n          ContentType: 'application/vnd.openxmlformats-officedocument.drawing+xml',\r\n        });\r\n      });\r\n    }\r\n\r\n    if (model.commentRefs) {\r\n      xmlStream.leafNode('Default', {\r\n        Extension: 'vml',\r\n        ContentType: 'application/vnd.openxmlformats-officedocument.vmlDrawing',\r\n      });\r\n\r\n      model.commentRefs.forEach(({commentName}) => {\r\n        xmlStream.leafNode('Override', {\r\n          PartName: `/xl/${commentName}.xml`,\r\n          ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml',\r\n        });\r\n      });\r\n    }\r\n\r\n    xmlStream.leafNode('Override', {\r\n      PartName: '/docProps/core.xml',\r\n      ContentType: 'application/vnd.openxmlformats-package.core-properties+xml',\r\n    });\r\n    xmlStream.leafNode('Override', {\r\n      PartName: '/docProps/app.xml',\r\n      ContentType: 'application/vnd.openxmlformats-officedocument.extended-properties+xml',\r\n    });\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen() {\r\n    return false;\r\n  }\r\n\r\n  parseText() {}\r\n\r\n  parseClose() {\r\n    return false;\r\n  }\r\n}\r\n\r\nContentTypesXform.PROPERTY_ATTRIBUTES = {\r\n  xmlns: 'http://schemas.openxmlformats.org/package/2006/content-types',\r\n};\r\n\r\nmodule.exports = ContentTypesXform;\r\n"],"file":"content-types-xform.js"}
=======
{"version":3,"file":"content-types-xform.js","names":["XmlStream","require","BaseXform","ContentTypesXform","render","xmlStream","model","openXml","StdDocAttributes","openNode","PROPERTY_ATTRIBUTES","mediaHash","media","forEach","medium","type","imageType","extension","leafNode","Extension","ContentType","PartName","worksheets","worksheet","name","id","hasSharedStrings","sharedStrings","count","tables","table","target","drawings","drawing","commentRefs","_ref","commentName","closeNode","parseOpen","parseText","parseClose","xmlns","module","exports"],"sources":["../../../../../lib/xlsx/xform/core/content-types-xform.js"],"sourcesContent":["const XmlStream = require('../../../utils/xml-stream');\n\nconst BaseXform = require('../base-xform');\n\n// used for rendering the [Content_Types].xml file\n// not used for parsing\nclass ContentTypesXform extends BaseXform {\n  render(xmlStream, model) {\n    xmlStream.openXml(XmlStream.StdDocAttributes);\n\n    xmlStream.openNode('Types', ContentTypesXform.PROPERTY_ATTRIBUTES);\n\n    const mediaHash = {};\n    (model.media || []).forEach(medium => {\n      if (medium.type === 'image') {\n        const imageType = medium.extension;\n        if (!mediaHash[imageType]) {\n          mediaHash[imageType] = true;\n          xmlStream.leafNode('Default', {Extension: imageType, ContentType: `image/${imageType}`});\n        }\n      }\n    });\n\n    xmlStream.leafNode('Default', {\n      Extension: 'rels',\n      ContentType: 'application/vnd.openxmlformats-package.relationships+xml',\n    });\n    xmlStream.leafNode('Default', {Extension: 'xml', ContentType: 'application/xml'});\n\n    xmlStream.leafNode('Override', {\n      PartName: '/xl/workbook.xml',\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml',\n    });\n\n    model.worksheets.forEach(worksheet => {\n      const name = `/xl/worksheets/sheet${worksheet.id}.xml`;\n      xmlStream.leafNode('Override', {\n        PartName: name,\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml',\n      });\n    });\n\n    xmlStream.leafNode('Override', {\n      PartName: '/xl/theme/theme1.xml',\n      ContentType: 'application/vnd.openxmlformats-officedocument.theme+xml',\n    });\n    xmlStream.leafNode('Override', {\n      PartName: '/xl/styles.xml',\n      ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml',\n    });\n\n    const hasSharedStrings = model.sharedStrings && model.sharedStrings.count;\n    if (hasSharedStrings) {\n      xmlStream.leafNode('Override', {\n        PartName: '/xl/sharedStrings.xml',\n        ContentType:\n          'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml',\n      });\n    }\n\n    if (model.tables) {\n      model.tables.forEach(table => {\n        xmlStream.leafNode('Override', {\n          PartName: `/xl/tables/${table.target}`,\n          ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml',\n        });\n      });\n    }\n\n    if (model.drawings) {\n      model.drawings.forEach(drawing => {\n        xmlStream.leafNode('Override', {\n          PartName: `/xl/drawings/${drawing.name}.xml`,\n          ContentType: 'application/vnd.openxmlformats-officedocument.drawing+xml',\n        });\n      });\n    }\n\n    if (model.commentRefs) {\n      xmlStream.leafNode('Default', {\n        Extension: 'vml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.vmlDrawing',\n      });\n\n      model.commentRefs.forEach(({commentName}) => {\n        xmlStream.leafNode('Override', {\n          PartName: `/xl/${commentName}.xml`,\n          ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml',\n        });\n      });\n    }\n\n    xmlStream.leafNode('Override', {\n      PartName: '/docProps/core.xml',\n      ContentType: 'application/vnd.openxmlformats-package.core-properties+xml',\n    });\n    xmlStream.leafNode('Override', {\n      PartName: '/docProps/app.xml',\n      ContentType: 'application/vnd.openxmlformats-officedocument.extended-properties+xml',\n    });\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen() {\n    return false;\n  }\n\n  parseText() {}\n\n  parseClose() {\n    return false;\n  }\n}\n\nContentTypesXform.PROPERTY_ATTRIBUTES = {\n  xmlns: 'http://schemas.openxmlformats.org/package/2006/content-types',\n};\n\nmodule.exports = ContentTypesXform;\n"],"mappings":"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"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
