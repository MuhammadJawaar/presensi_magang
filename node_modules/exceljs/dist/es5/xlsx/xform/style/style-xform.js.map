<<<<<<< HEAD
{"version":3,"sources":["../../../../../lib/xlsx/xform/style/style-xform.js"],"names":["BaseXform","require","AlignmentXform","ProtectionXform","StyleXform","options","xfId","map","alignment","protection","xmlStream","model","openNode","numFmtId","fontId","fillId","borderId","addAttribute","render","closeNode","node","parser","parseOpen","name","parseInt","attributes","text","parseText","parseClose","undefined","module","exports"],"mappings":"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","sourcesContent":["const BaseXform = require('../base-xform');\r\n\r\nconst AlignmentXform = require('./alignment-xform');\r\nconst ProtectionXform = require('./protection-xform');\r\n\r\n// <xf numFmtId=\"[numFmtId]\" fontId=\"[fontId]\" fillId=\"[fillId]\" borderId=\"[xf.borderId]\" xfId=\"[xfId]\">\r\n//   Optional <alignment>\r\n//   Optional <protection>\r\n// </xf>\r\n\r\n// Style assists translation from style model to/from xlsx\r\nclass StyleXform extends BaseXform {\r\n  constructor(options) {\r\n    super();\r\n\r\n    this.xfId = !!(options && options.xfId);\r\n    this.map = {\r\n      alignment: new AlignmentXform(),\r\n      protection: new ProtectionXform(),\r\n    };\r\n  }\r\n\r\n  get tag() {\r\n    return 'xf';\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    xmlStream.openNode('xf', {\r\n      numFmtId: model.numFmtId || 0,\r\n      fontId: model.fontId || 0,\r\n      fillId: model.fillId || 0,\r\n      borderId: model.borderId || 0,\r\n    });\r\n    if (this.xfId) {\r\n      xmlStream.addAttribute('xfId', model.xfId || 0);\r\n    }\r\n\r\n    if (model.numFmtId) {\r\n      xmlStream.addAttribute('applyNumberFormat', '1');\r\n    }\r\n    if (model.fontId) {\r\n      xmlStream.addAttribute('applyFont', '1');\r\n    }\r\n    if (model.fillId) {\r\n      xmlStream.addAttribute('applyFill', '1');\r\n    }\r\n    if (model.borderId) {\r\n      xmlStream.addAttribute('applyBorder', '1');\r\n    }\r\n    if (model.alignment) {\r\n      xmlStream.addAttribute('applyAlignment', '1');\r\n    }\r\n    if (model.protection) {\r\n      xmlStream.addAttribute('applyProtection', '1');\r\n    }\r\n\r\n    /**\r\n     * Rendering tags causes close of XML stream.\r\n     * Therefore adding attributes must be done before rendering tags.\r\n     */\r\n\r\n    if (model.alignment) {\r\n      this.map.alignment.render(xmlStream, model.alignment);\r\n    }\r\n    if (model.protection) {\r\n      this.map.protection.render(xmlStream, model.protection);\r\n    }\r\n\r\n    xmlStream.closeNode();\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    // used during sax parsing of xml to build font object\r\n    switch (node.name) {\r\n      case 'xf':\r\n        this.model = {\r\n          numFmtId: parseInt(node.attributes.numFmtId, 10),\r\n          fontId: parseInt(node.attributes.fontId, 10),\r\n          fillId: parseInt(node.attributes.fillId, 10),\r\n          borderId: parseInt(node.attributes.borderId, 10),\r\n        };\r\n        if (this.xfId) {\r\n          this.model.xfId = parseInt(node.attributes.xfId, 10);\r\n        }\r\n        return true;\r\n      case 'alignment':\r\n        this.parser = this.map.alignment;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      case 'protection':\r\n        this.parser = this.map.protection;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        if (this.map.protection === this.parser) {\r\n          this.model.protection = this.parser.model;\r\n        } else {\r\n          this.model.alignment = this.parser.model;\r\n        }\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    return name !== 'xf';\r\n  }\r\n}\r\n\r\nmodule.exports = StyleXform;\r\n"],"file":"style-xform.js"}
=======
{"version":3,"file":"style-xform.js","names":["BaseXform","require","AlignmentXform","ProtectionXform","StyleXform","constructor","options","xfId","map","alignment","protection","tag","render","xmlStream","model","openNode","numFmtId","fontId","fillId","borderId","addAttribute","closeNode","parseOpen","node","parser","name","parseInt","attributes","parseText","text","parseClose","undefined","module","exports"],"sources":["../../../../../lib/xlsx/xform/style/style-xform.js"],"sourcesContent":["const BaseXform = require('../base-xform');\n\nconst AlignmentXform = require('./alignment-xform');\nconst ProtectionXform = require('./protection-xform');\n\n// <xf numFmtId=\"[numFmtId]\" fontId=\"[fontId]\" fillId=\"[fillId]\" borderId=\"[xf.borderId]\" xfId=\"[xfId]\">\n//   Optional <alignment>\n//   Optional <protection>\n// </xf>\n\n// Style assists translation from style model to/from xlsx\nclass StyleXform extends BaseXform {\n  constructor(options) {\n    super();\n\n    this.xfId = !!(options && options.xfId);\n    this.map = {\n      alignment: new AlignmentXform(),\n      protection: new ProtectionXform(),\n    };\n  }\n\n  get tag() {\n    return 'xf';\n  }\n\n  render(xmlStream, model) {\n    xmlStream.openNode('xf', {\n      numFmtId: model.numFmtId || 0,\n      fontId: model.fontId || 0,\n      fillId: model.fillId || 0,\n      borderId: model.borderId || 0,\n    });\n    if (this.xfId) {\n      xmlStream.addAttribute('xfId', model.xfId || 0);\n    }\n\n    if (model.numFmtId) {\n      xmlStream.addAttribute('applyNumberFormat', '1');\n    }\n    if (model.fontId) {\n      xmlStream.addAttribute('applyFont', '1');\n    }\n    if (model.fillId) {\n      xmlStream.addAttribute('applyFill', '1');\n    }\n    if (model.borderId) {\n      xmlStream.addAttribute('applyBorder', '1');\n    }\n    if (model.alignment) {\n      xmlStream.addAttribute('applyAlignment', '1');\n    }\n    if (model.protection) {\n      xmlStream.addAttribute('applyProtection', '1');\n    }\n\n    /**\n     * Rendering tags causes close of XML stream.\n     * Therefore adding attributes must be done before rendering tags.\n     */\n\n    if (model.alignment) {\n      this.map.alignment.render(xmlStream, model.alignment);\n    }\n    if (model.protection) {\n      this.map.protection.render(xmlStream, model.protection);\n    }\n\n    xmlStream.closeNode();\n  }\n\n  parseOpen(node) {\n    if (this.parser) {\n      this.parser.parseOpen(node);\n      return true;\n    }\n    // used during sax parsing of xml to build font object\n    switch (node.name) {\n      case 'xf':\n        this.model = {\n          numFmtId: parseInt(node.attributes.numFmtId, 10),\n          fontId: parseInt(node.attributes.fontId, 10),\n          fillId: parseInt(node.attributes.fillId, 10),\n          borderId: parseInt(node.attributes.borderId, 10),\n        };\n        if (this.xfId) {\n          this.model.xfId = parseInt(node.attributes.xfId, 10);\n        }\n        return true;\n      case 'alignment':\n        this.parser = this.map.alignment;\n        this.parser.parseOpen(node);\n        return true;\n      case 'protection':\n        this.parser = this.map.protection;\n        this.parser.parseOpen(node);\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  parseText(text) {\n    if (this.parser) {\n      this.parser.parseText(text);\n    }\n  }\n\n  parseClose(name) {\n    if (this.parser) {\n      if (!this.parser.parseClose(name)) {\n        if (this.map.protection === this.parser) {\n          this.model.protection = this.parser.model;\n        } else {\n          this.model.alignment = this.parser.model;\n        }\n        this.parser = undefined;\n      }\n      return true;\n    }\n    return name !== 'xf';\n  }\n}\n\nmodule.exports = StyleXform;\n"],"mappings":"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"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
