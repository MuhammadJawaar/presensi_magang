<<<<<<< HEAD
{"version":3,"sources":["../../../lib/utils/iterate-stream.js"],"names":["module","exports","stream","contents","on","data","push","streamEndedPromise","Promise","resolve","resolveStreamEndedPromise","ended","error","err","length","resume","race","once","pause","shift","iterateStream","eventEmitter","type","fired","handler","removeListener","addListener"],"mappings":";;;;;;;;;;;;;;;;;;AAAAA,MAAM,CAACC,OAAP;AAAA,iFAAiB,iBAA8BC,MAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AACTC,YAAAA,QADS,GACE,EADF;AAEfD,YAAAA,MAAM,CAACE,EAAP,CAAU,MAAV,EAAkB,UAAAC,IAAI;AAAA,qBAAIF,QAAQ,CAACG,IAAT,CAAcD,IAAd,CAAJ;AAAA,aAAtB;AAGME,YAAAA,kBALS,GAKY,IAAIC,OAAJ,CAAY,UAAAC,OAAO;AAAA,qBAAKC,yBAAyB,GAAGD,OAAjC;AAAA,aAAnB,CALZ;AAOXE,YAAAA,KAPW,GAOH,KAPG;AAQfT,YAAAA,MAAM,CAACE,EAAP,CAAU,KAAV,EAAiB,YAAM;AACrBO,cAAAA,KAAK,GAAG,IAAR;AACAD,cAAAA,yBAAyB;AAC1B,aAHD;AAKIE,YAAAA,KAbW,GAaH,KAbG;AAcfV,YAAAA,MAAM,CAACE,EAAP,CAAU,OAAV,EAAmB,UAAAS,GAAG,EAAI;AACxBD,cAAAA,KAAK,GAAGC,GAAR;AACAH,cAAAA,yBAAyB;AAC1B,aAHD;;AAde;AAAA,kBAmBR,CAACC,KAAD,IAAUR,QAAQ,CAACW,MAAT,GAAkB,CAnBpB;AAAA;AAAA;AAAA;;AAAA,kBAoBTX,QAAQ,CAACW,MAAT,KAAoB,CApBX;AAAA;AAAA;AAAA;;AAqBXZ,YAAAA,MAAM,CAACa,MAAP,GArBW,CAsBX;;AAtBW;AAAA,wCAuBLP,OAAO,CAACQ,IAAR,CAAa,CAACC,IAAI,CAACf,MAAD,EAAS,MAAT,CAAL,EAAuBK,kBAAvB,CAAb,CAvBK;;AAAA;AAAA;AAAA;;AAAA;AAyBXL,YAAAA,MAAM,CAACgB,KAAP;AACMb,YAAAA,IA1BK,GA0BEF,QAAQ,CAACgB,KAAT,EA1BF;AAAA;AA2BX,mBAAMd,IAAN;;AA3BW;AAAA,iBA6BTO,KA7BS;AAAA;AAAA;AAAA;;AAAA,kBA6BIA,KA7BJ;;AAAA;AAAA;AAAA;;AAAA;AA+BfF,YAAAA,yBAAyB;;AA/BV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA,WAAiCU,aAAjC;AAAA;AAAA;;AAAA,SAAiCA,aAAjC;AAAA;;AAkCA,SAASH,IAAT,CAAcI,YAAd,EAA4BC,IAA5B,EAAkC;AAChC;AACA,SAAO,IAAId,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC5B,QAAIc,KAAK,GAAG,KAAZ;;AACA,QAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;AACpB,UAAI,CAACD,KAAL,EAAY;AACVA,QAAAA,KAAK,GAAG,IAAR;AACAF,QAAAA,YAAY,CAACI,cAAb,CAA4BH,IAA5B,EAAkCE,OAAlC;AACAf,QAAAA,OAAO;AACR;AACF,KAND;;AAOAY,IAAAA,YAAY,CAACK,WAAb,CAAyBJ,IAAzB,EAA+BE,OAA/B;AACD,GAVM,CAAP;AAWD","sourcesContent":["module.exports = async function* iterateStream(stream) {\r\n  const contents = [];\r\n  stream.on('data', data => contents.push(data));\r\n\r\n  let resolveStreamEndedPromise;\r\n  const streamEndedPromise = new Promise(resolve => (resolveStreamEndedPromise = resolve));\r\n\r\n  let ended = false;\r\n  stream.on('end', () => {\r\n    ended = true;\r\n    resolveStreamEndedPromise();\r\n  });\r\n\r\n  let error = false;\r\n  stream.on('error', err => {\r\n    error = err;\r\n    resolveStreamEndedPromise();\r\n  });\r\n\r\n  while (!ended || contents.length > 0) {\r\n    if (contents.length === 0) {\r\n      stream.resume();\r\n      // eslint-disable-next-line no-await-in-loop\r\n      await Promise.race([once(stream, 'data'), streamEndedPromise]);\r\n    } else {\r\n      stream.pause();\r\n      const data = contents.shift();\r\n      yield data;\r\n    }\r\n    if (error) throw error;\r\n  }\r\n  resolveStreamEndedPromise();\r\n};\r\n\r\nfunction once(eventEmitter, type) {\r\n  // TODO: Use require('events').once when node v10 is dropped\r\n  return new Promise(resolve => {\r\n    let fired = false;\r\n    const handler = () => {\r\n      if (!fired) {\r\n        fired = true;\r\n        eventEmitter.removeListener(type, handler);\r\n        resolve();\r\n      }\r\n    };\r\n    eventEmitter.addListener(type, handler);\r\n  });\r\n}\r\n"],"file":"iterate-stream.js"}
=======
{"version":3,"file":"iterate-stream.js","names":["module","exports","iterateStream","stream","contents","on","data","push","resolveStreamEndedPromise","streamEndedPromise","Promise","resolve","ended","error","err","length","resume","race","once","pause","shift","eventEmitter","type","fired","handler","removeListener","addListener"],"sources":["../../../lib/utils/iterate-stream.js"],"sourcesContent":["module.exports = async function* iterateStream(stream) {\n  const contents = [];\n  stream.on('data', data => contents.push(data));\n\n  let resolveStreamEndedPromise;\n  const streamEndedPromise = new Promise(resolve => (resolveStreamEndedPromise = resolve));\n\n  let ended = false;\n  stream.on('end', () => {\n    ended = true;\n    resolveStreamEndedPromise();\n  });\n\n  let error = false;\n  stream.on('error', err => {\n    error = err;\n    resolveStreamEndedPromise();\n  });\n\n  while (!ended || contents.length > 0) {\n    if (contents.length === 0) {\n      stream.resume();\n      // eslint-disable-next-line no-await-in-loop\n      await Promise.race([once(stream, 'data'), streamEndedPromise]);\n    } else {\n      stream.pause();\n      const data = contents.shift();\n      yield data;\n    }\n    if (error) throw error;\n  }\n  resolveStreamEndedPromise();\n};\n\nfunction once(eventEmitter, type) {\n  // TODO: Use require('events').once when node v10 is dropped\n  return new Promise(resolve => {\n    let fired = false;\n    const handler = () => {\n      if (!fired) {\n        fired = true;\n        eventEmitter.removeListener(type, handler);\n        resolve();\n      }\n    };\n    eventEmitter.addListener(type, handler);\n  });\n}\n"],"mappings":";;AAAAA,MAAM,CAACC,OAAO,GAAG,gBAAgBC,aAAaA,CAACC,MAAM,EAAE;EACrD,MAAMC,QAAQ,GAAG,EAAE;EACnBD,MAAM,CAACE,EAAE,CAAC,MAAM,EAAEC,IAAI,IAAIF,QAAQ,CAACG,IAAI,CAACD,IAAI,CAAC,CAAC;EAE9C,IAAIE,yBAAyB;EAC7B,MAAMC,kBAAkB,GAAG,IAAIC,OAAO,CAACC,OAAO,IAAKH,yBAAyB,GAAGG,OAAQ,CAAC;EAExF,IAAIC,KAAK,GAAG,KAAK;EACjBT,MAAM,CAACE,EAAE,CAAC,KAAK,EAAE,MAAM;IACrBO,KAAK,GAAG,IAAI;IACZJ,yBAAyB,CAAC,CAAC;EAC7B,CAAC,CAAC;EAEF,IAAIK,KAAK,GAAG,KAAK;EACjBV,MAAM,CAACE,EAAE,CAAC,OAAO,EAAES,GAAG,IAAI;IACxBD,KAAK,GAAGC,GAAG;IACXN,yBAAyB,CAAC,CAAC;EAC7B,CAAC,CAAC;EAEF,OAAO,CAACI,KAAK,IAAIR,QAAQ,CAACW,MAAM,GAAG,CAAC,EAAE;IACpC,IAAIX,QAAQ,CAACW,MAAM,KAAK,CAAC,EAAE;MACzBZ,MAAM,CAACa,MAAM,CAAC,CAAC;MACf;MACA,MAAMN,OAAO,CAACO,IAAI,CAAC,CAACC,IAAI,CAACf,MAAM,EAAE,MAAM,CAAC,EAAEM,kBAAkB,CAAC,CAAC;IAChE,CAAC,MAAM;MACLN,MAAM,CAACgB,KAAK,CAAC,CAAC;MACd,MAAMb,IAAI,GAAGF,QAAQ,CAACgB,KAAK,CAAC,CAAC;MAC7B,MAAMd,IAAI;IACZ;IACA,IAAIO,KAAK,EAAE,MAAMA,KAAK;EACxB;EACAL,yBAAyB,CAAC,CAAC;AAC7B,CAAC;AAED,SAASU,IAAIA,CAACG,YAAY,EAAEC,IAAI,EAAE;EAChC;EACA,OAAO,IAAIZ,OAAO,CAACC,OAAO,IAAI;IAC5B,IAAIY,KAAK,GAAG,KAAK;IACjB,MAAMC,OAAO,GAAGA,CAAA,KAAM;MACpB,IAAI,CAACD,KAAK,EAAE;QACVA,KAAK,GAAG,IAAI;QACZF,YAAY,CAACI,cAAc,CAACH,IAAI,EAAEE,OAAO,CAAC;QAC1Cb,OAAO,CAAC,CAAC;MACX;IACF,CAAC;IACDU,YAAY,CAACK,WAAW,CAACJ,IAAI,EAAEE,OAAO,CAAC;EACzC,CAAC,CAAC;AACJ"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
