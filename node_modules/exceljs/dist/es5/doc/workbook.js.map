<<<<<<< HEAD
{"version":3,"sources":["../../../lib/doc/workbook.js"],"names":["Worksheet","require","DefinedNames","XLSX","CSV","Workbook","category","company","created","Date","description","keywords","manager","modified","properties","calcProperties","_worksheets","subject","title","views","media","_definedNames","name","options","id","nextId","length","console","warn","test","Error","substring","find","ws","toLowerCase","trace","tabColor","argb","theme","indexed","lastOrderNo","reduce","acc","orderNo","worksheetOptions","Object","assign","workbook","worksheet","getWorksheet","destroy","undefined","Boolean","iteratee","worksheets","forEach","sheet","_themes","image","push","type","_xlsx","_csv","i","slice","sort","a","b","filter","creator","lastModifiedBy","lastPrinted","map","model","sheets","definedNames","language","revision","contentStatus","themes","value","worksheetModel","state","findIndex","module","exports"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nconst Worksheet = require('./worksheet');\r\nconst DefinedNames = require('./defined-names');\r\nconst XLSX = require('../xlsx/xlsx');\r\nconst CSV = require('../csv/csv');\r\n\r\n// Workbook requirements\r\n//  Load and Save from file and stream\r\n//  Access/Add/Delete individual worksheets\r\n//  Manage String table, Hyperlink table, etc.\r\n//  Manage scaffolding for contained objects to write to/read from\r\n\r\nclass Workbook {\r\n  constructor() {\r\n    this.category = '';\r\n    this.company = '';\r\n    this.created = new Date();\r\n    this.description = '';\r\n    this.keywords = '';\r\n    this.manager = '';\r\n    this.modified = this.created;\r\n    this.properties = {};\r\n    this.calcProperties = {};\r\n    this._worksheets = [];\r\n    this.subject = '';\r\n    this.title = '';\r\n    this.views = [];\r\n    this.media = [];\r\n    this._definedNames = new DefinedNames();\r\n  }\r\n\r\n  get xlsx() {\r\n    if (!this._xlsx) this._xlsx = new XLSX(this);\r\n    return this._xlsx;\r\n  }\r\n\r\n  get csv() {\r\n    if (!this._csv) this._csv = new CSV(this);\r\n    return this._csv;\r\n  }\r\n\r\n  get nextId() {\r\n    // find the next unique spot to add worksheet\r\n    for (let i = 1; i < this._worksheets.length; i++) {\r\n      if (!this._worksheets[i]) {\r\n        return i;\r\n      }\r\n    }\r\n    return this._worksheets.length || 1;\r\n  }\r\n\r\n  addWorksheet(name, options) {\r\n    const id = this.nextId;\r\n\r\n    if (name && name.length > 31) {\r\n      // eslint-disable-next-line no-console\r\n      console.warn(`Worksheet name ${name} exceeds 31 chars. This will be truncated`);\r\n    }\r\n\r\n    // Illegal character in worksheet name: asterisk (*), question mark (?),\r\n    // colon (:), forward slash (/ \\), or bracket ([])\r\n    if (/[*?:/\\\\[\\]]/.test(name)) {\r\n      throw new Error(\r\n        `Worksheet name ${name} cannot include any of the following characters: * ? : \\\\ / [ ]`\r\n      );\r\n    }\r\n\r\n    if (/(^')|('$)/.test(name)) {\r\n      throw new Error(\r\n        `The first or last character of worksheet name cannot be a single quotation mark: ${name}`\r\n      );\r\n    }\r\n\r\n    name = (name || `sheet${id}`).substring(0, 31);\r\n    if (this._worksheets.find(ws => ws && ws.name.toLowerCase() === name.toLowerCase())) {\r\n      throw new Error(`Worksheet name already exists: ${name}`);\r\n    }\r\n\r\n    // if options is a color, call it tabColor (and signal deprecated message)\r\n    if (options) {\r\n      if (typeof options === 'string') {\r\n        // eslint-disable-next-line no-console\r\n        console.trace(\r\n          'tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: \"rbg value\" } }'\r\n        );\r\n        options = {\r\n          properties: {\r\n            tabColor: {argb: options},\r\n          },\r\n        };\r\n      } else if (options.argb || options.theme || options.indexed) {\r\n        // eslint-disable-next-line no-console\r\n        console.trace(\r\n          'tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }'\r\n        );\r\n        options = {\r\n          properties: {\r\n            tabColor: options,\r\n          },\r\n        };\r\n      }\r\n    }\r\n\r\n    const lastOrderNo = this._worksheets.reduce(\r\n      (acc, ws) => ((ws && ws.orderNo) > acc ? ws.orderNo : acc),\r\n      0\r\n    );\r\n    const worksheetOptions = Object.assign({}, options, {\r\n      id,\r\n      name,\r\n      orderNo: lastOrderNo + 1,\r\n      workbook: this,\r\n    });\r\n\r\n    const worksheet = new Worksheet(worksheetOptions);\r\n\r\n    this._worksheets[id] = worksheet;\r\n    return worksheet;\r\n  }\r\n\r\n  removeWorksheetEx(worksheet) {\r\n    delete this._worksheets[worksheet.id];\r\n  }\r\n\r\n  removeWorksheet(id) {\r\n    const worksheet = this.getWorksheet(id);\r\n    if (worksheet) {\r\n      worksheet.destroy();\r\n    }\r\n  }\r\n\r\n  getWorksheet(id) {\r\n    if (id === undefined) {\r\n      return this._worksheets.find(Boolean);\r\n    }\r\n    if (typeof id === 'number') {\r\n      return this._worksheets[id];\r\n    }\r\n    if (typeof id === 'string') {\r\n      return this._worksheets.find(worksheet => worksheet && worksheet.name === id);\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  get worksheets() {\r\n    // return a clone of _worksheets\r\n    return this._worksheets\r\n      .slice(1)\r\n      .sort((a, b) => a.orderNo - b.orderNo)\r\n      .filter(Boolean);\r\n  }\r\n\r\n  eachSheet(iteratee) {\r\n    this.worksheets.forEach(sheet => {\r\n      iteratee(sheet, sheet.id);\r\n    });\r\n  }\r\n\r\n  get definedNames() {\r\n    return this._definedNames;\r\n  }\r\n\r\n  clearThemes() {\r\n    // Note: themes are not an exposed feature, meddle at your peril!\r\n    this._themes = undefined;\r\n  }\r\n\r\n  addImage(image) {\r\n    // TODO:  validation?\r\n    const id = this.media.length;\r\n    this.media.push(Object.assign({}, image, {type: 'image'}));\r\n    return id;\r\n  }\r\n\r\n  getImage(id) {\r\n    return this.media[id];\r\n  }\r\n\r\n  get model() {\r\n    return {\r\n      creator: this.creator || 'Unknown',\r\n      lastModifiedBy: this.lastModifiedBy || 'Unknown',\r\n      lastPrinted: this.lastPrinted,\r\n      created: this.created,\r\n      modified: this.modified,\r\n      properties: this.properties,\r\n      worksheets: this.worksheets.map(worksheet => worksheet.model),\r\n      sheets: this.worksheets.map(ws => ws.model).filter(Boolean),\r\n      definedNames: this._definedNames.model,\r\n      views: this.views,\r\n      company: this.company,\r\n      manager: this.manager,\r\n      title: this.title,\r\n      subject: this.subject,\r\n      keywords: this.keywords,\r\n      category: this.category,\r\n      description: this.description,\r\n      language: this.language,\r\n      revision: this.revision,\r\n      contentStatus: this.contentStatus,\r\n      themes: this._themes,\r\n      media: this.media,\r\n      calcProperties: this.calcProperties,\r\n    };\r\n  }\r\n\r\n  set model(value) {\r\n    this.creator = value.creator;\r\n    this.lastModifiedBy = value.lastModifiedBy;\r\n    this.lastPrinted = value.lastPrinted;\r\n    this.created = value.created;\r\n    this.modified = value.modified;\r\n    this.company = value.company;\r\n    this.manager = value.manager;\r\n    this.title = value.title;\r\n    this.subject = value.subject;\r\n    this.keywords = value.keywords;\r\n    this.category = value.category;\r\n    this.description = value.description;\r\n    this.language = value.language;\r\n    this.revision = value.revision;\r\n    this.contentStatus = value.contentStatus;\r\n\r\n    this.properties = value.properties;\r\n    this.calcProperties = value.calcProperties;\r\n    this._worksheets = [];\r\n    value.worksheets.forEach(worksheetModel => {\r\n      const {id, name, state} = worksheetModel;\r\n      const orderNo = value.sheets && value.sheets.findIndex(ws => ws.id === id);\r\n      const worksheet = (this._worksheets[id] = new Worksheet({\r\n        id,\r\n        name,\r\n        orderNo,\r\n        state,\r\n        workbook: this,\r\n      }));\r\n\r\n      worksheet.model = worksheetModel;\r\n    });\r\n\r\n    this._definedNames.model = value.definedNames;\r\n    this.views = value.views;\r\n    this._themes = value.themes;\r\n    this.media = value.media || [];\r\n  }\r\n}\r\n\r\nmodule.exports = Workbook;\r\n"],"file":"workbook.js"}
=======
{"version":3,"file":"workbook.js","names":["Worksheet","require","DefinedNames","XLSX","CSV","Workbook","constructor","category","company","created","Date","description","keywords","manager","modified","properties","calcProperties","_worksheets","subject","title","views","media","_definedNames","xlsx","_xlsx","csv","_csv","nextId","i","length","addWorksheet","name","options","id","console","trace","tabColor","argb","theme","indexed","lastOrderNo","reduce","acc","ws","orderNo","worksheetOptions","Object","assign","workbook","worksheet","removeWorksheetEx","removeWorksheet","getWorksheet","destroy","undefined","find","Boolean","worksheets","slice","sort","a","b","filter","eachSheet","iteratee","forEach","sheet","definedNames","clearThemes","_themes","addImage","image","push","type","getImage","model","creator","lastModifiedBy","lastPrinted","map","sheets","language","revision","contentStatus","themes","value","worksheetModel","state","findIndex","module","exports"],"sources":["../../../lib/doc/workbook.js"],"sourcesContent":["'use strict';\n\nconst Worksheet = require('./worksheet');\nconst DefinedNames = require('./defined-names');\nconst XLSX = require('../xlsx/xlsx');\nconst CSV = require('../csv/csv');\n\n// Workbook requirements\n//  Load and Save from file and stream\n//  Access/Add/Delete individual worksheets\n//  Manage String table, Hyperlink table, etc.\n//  Manage scaffolding for contained objects to write to/read from\n\nclass Workbook {\n  constructor() {\n    this.category = '';\n    this.company = '';\n    this.created = new Date();\n    this.description = '';\n    this.keywords = '';\n    this.manager = '';\n    this.modified = this.created;\n    this.properties = {};\n    this.calcProperties = {};\n    this._worksheets = [];\n    this.subject = '';\n    this.title = '';\n    this.views = [];\n    this.media = [];\n    this._definedNames = new DefinedNames();\n  }\n\n  get xlsx() {\n    if (!this._xlsx) this._xlsx = new XLSX(this);\n    return this._xlsx;\n  }\n\n  get csv() {\n    if (!this._csv) this._csv = new CSV(this);\n    return this._csv;\n  }\n\n  get nextId() {\n    // find the next unique spot to add worksheet\n    for (let i = 1; i < this._worksheets.length; i++) {\n      if (!this._worksheets[i]) {\n        return i;\n      }\n    }\n    return this._worksheets.length || 1;\n  }\n\n  addWorksheet(name, options) {\n    const id = this.nextId;\n\n    // if options is a color, call it tabColor (and signal deprecated message)\n    if (options) {\n      if (typeof options === 'string') {\n        // eslint-disable-next-line no-console\n        console.trace(\n          'tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: \"rbg value\" } }'\n        );\n        options = {\n          properties: {\n            tabColor: {argb: options},\n          },\n        };\n      } else if (options.argb || options.theme || options.indexed) {\n        // eslint-disable-next-line no-console\n        console.trace(\n          'tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }'\n        );\n        options = {\n          properties: {\n            tabColor: options,\n          },\n        };\n      }\n    }\n\n    const lastOrderNo = this._worksheets.reduce((acc, ws) => ((ws && ws.orderNo) > acc ? ws.orderNo : acc), 0);\n    const worksheetOptions = Object.assign({}, options, {\n      id,\n      name,\n      orderNo: lastOrderNo + 1,\n      workbook: this,\n    });\n\n    const worksheet = new Worksheet(worksheetOptions);\n\n    this._worksheets[id] = worksheet;\n    return worksheet;\n  }\n\n  removeWorksheetEx(worksheet) {\n    delete this._worksheets[worksheet.id];\n  }\n\n  removeWorksheet(id) {\n    const worksheet = this.getWorksheet(id);\n    if (worksheet) {\n      worksheet.destroy();\n    }\n  }\n\n  getWorksheet(id) {\n    if (id === undefined) {\n      return this._worksheets.find(Boolean);\n    }\n    if (typeof id === 'number') {\n      return this._worksheets[id];\n    }\n    if (typeof id === 'string') {\n      return this._worksheets.find(worksheet => worksheet && worksheet.name === id);\n    }\n    return undefined;\n  }\n\n  get worksheets() {\n    // return a clone of _worksheets\n    return this._worksheets\n      .slice(1)\n      .sort((a, b) => a.orderNo - b.orderNo)\n      .filter(Boolean);\n  }\n\n  eachSheet(iteratee) {\n    this.worksheets.forEach(sheet => {\n      iteratee(sheet, sheet.id);\n    });\n  }\n\n  get definedNames() {\n    return this._definedNames;\n  }\n\n  clearThemes() {\n    // Note: themes are not an exposed feature, meddle at your peril!\n    this._themes = undefined;\n  }\n\n  addImage(image) {\n    // TODO:  validation?\n    const id = this.media.length;\n    this.media.push(Object.assign({}, image, {type: 'image'}));\n    return id;\n  }\n\n  getImage(id) {\n    return this.media[id];\n  }\n\n  get model() {\n    return {\n      creator: this.creator || 'Unknown',\n      lastModifiedBy: this.lastModifiedBy || 'Unknown',\n      lastPrinted: this.lastPrinted,\n      created: this.created,\n      modified: this.modified,\n      properties: this.properties,\n      worksheets: this.worksheets.map(worksheet => worksheet.model),\n      sheets: this.worksheets.map(ws => ws.model).filter(Boolean),\n      definedNames: this._definedNames.model,\n      views: this.views,\n      company: this.company,\n      manager: this.manager,\n      title: this.title,\n      subject: this.subject,\n      keywords: this.keywords,\n      category: this.category,\n      description: this.description,\n      language: this.language,\n      revision: this.revision,\n      contentStatus: this.contentStatus,\n      themes: this._themes,\n      media: this.media,\n      calcProperties: this.calcProperties,\n    };\n  }\n\n  set model(value) {\n    this.creator = value.creator;\n    this.lastModifiedBy = value.lastModifiedBy;\n    this.lastPrinted = value.lastPrinted;\n    this.created = value.created;\n    this.modified = value.modified;\n    this.company = value.company;\n    this.manager = value.manager;\n    this.title = value.title;\n    this.subject = value.subject;\n    this.keywords = value.keywords;\n    this.category = value.category;\n    this.description = value.description;\n    this.language = value.language;\n    this.revision = value.revision;\n    this.contentStatus = value.contentStatus;\n\n    this.properties = value.properties;\n    this.calcProperties = value.calcProperties;\n    this._worksheets = [];\n    value.worksheets.forEach(worksheetModel => {\n      const {id, name, state} = worksheetModel;\n      const orderNo = value.sheets && value.sheets.findIndex(ws => ws.id === id);\n      const worksheet = (this._worksheets[id] = new Worksheet({\n        id,\n        name,\n        orderNo,\n        state,\n        workbook: this,\n      }));\n      worksheet.model = worksheetModel;\n    });\n\n    this._definedNames.model = value.definedNames;\n    this.views = value.views;\n    this._themes = value.themes;\n    this.media = value.media || [];\n  }\n}\n\nmodule.exports = Workbook;\n"],"mappings":"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"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
