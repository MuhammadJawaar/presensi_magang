<<<<<<< HEAD
{"version":3,"sources":["../../../lib/doc/table.js"],"names":["colCache","require","Column","table","column","index","name","value","cacheState","_set","filterButton","style","totalsRowLabel","totalsRowFunction","totalsRowResult","totalsRowFormula","Table","worksheet","validate","store","Error","assign","o","dflt","undefined","assert","test","message","ref","columns","rows","tl","decodeAddress","row","col","width","filterHeight","tableHeight","autoFilterRef","encode","tableRef","forEach","i","getFormula","assignStyle","cell","Object","keys","key","count","headerRow","r","getRow","j","getCell","data","totalsRow","formula","result","_cache","values","rowNumber","push","splice","rowIndex","colIndex","target","prop","length","height","_assign","displyName","displayName","showFirstColumn","showLastColumn","showRowStripes","showColumnStripes","module","exports"],"mappings":"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","sourcesContent":["/* eslint-disable max-classes-per-file */\r\nconst colCache = require('../utils/col-cache');\r\n\r\nclass Column {\r\n  // wrapper around column model, allowing access and manipulation\r\n  constructor(table, column, index) {\r\n    this.table = table;\r\n    this.column = column;\r\n    this.index = index;\r\n  }\r\n\r\n  _set(name, value) {\r\n    this.table.cacheState();\r\n    this.column[name] = value;\r\n  }\r\n\r\n  /* eslint-disable lines-between-class-members */\r\n  get name() {\r\n    return this.column.name;\r\n  }\r\n  set name(value) {\r\n    this._set('name', value);\r\n  }\r\n\r\n  get filterButton() {\r\n    return this.column.filterButton;\r\n  }\r\n  set filterButton(value) {\r\n    this.column.filterButton = value;\r\n  }\r\n\r\n  get style() {\r\n    return this.column.style;\r\n  }\r\n  set style(value) {\r\n    this.column.style = value;\r\n  }\r\n\r\n  get totalsRowLabel() {\r\n    return this.column.totalsRowLabel;\r\n  }\r\n  set totalsRowLabel(value) {\r\n    this._set('totalsRowLabel', value);\r\n  }\r\n\r\n  get totalsRowFunction() {\r\n    return this.column.totalsRowFunction;\r\n  }\r\n  set totalsRowFunction(value) {\r\n    this._set('totalsRowFunction', value);\r\n  }\r\n\r\n  get totalsRowResult() {\r\n    return this.column.totalsRowResult;\r\n  }\r\n  set totalsRowResult(value) {\r\n    this._set('totalsRowResult', value);\r\n  }\r\n\r\n  get totalsRowFormula() {\r\n    return this.column.totalsRowFormula;\r\n  }\r\n  set totalsRowFormula(value) {\r\n    this._set('totalsRowFormula', value);\r\n  }\r\n  /* eslint-enable lines-between-class-members */\r\n}\r\n\r\nclass Table {\r\n  constructor(worksheet, table) {\r\n    this.worksheet = worksheet;\r\n    if (table) {\r\n      this.table = table;\r\n      // check things are ok first\r\n      this.validate();\r\n\r\n      this.store();\r\n    }\r\n  }\r\n\r\n  getFormula(column) {\r\n    // get the correct formula to apply to the totals row\r\n    switch (column.totalsRowFunction) {\r\n      case 'none':\r\n        return null;\r\n      case 'average':\r\n        return `SUBTOTAL(101,${this.table.name}[${column.name}])`;\r\n      case 'countNums':\r\n        return `SUBTOTAL(102,${this.table.name}[${column.name}])`;\r\n      case 'count':\r\n        return `SUBTOTAL(103,${this.table.name}[${column.name}])`;\r\n      case 'max':\r\n        return `SUBTOTAL(104,${this.table.name}[${column.name}])`;\r\n      case 'min':\r\n        return `SUBTOTAL(105,${this.table.name}[${column.name}])`;\r\n      case 'stdDev':\r\n        return `SUBTOTAL(106,${this.table.name}[${column.name}])`;\r\n      case 'var':\r\n        return `SUBTOTAL(107,${this.table.name}[${column.name}])`;\r\n      case 'sum':\r\n        return `SUBTOTAL(109,${this.table.name}[${column.name}])`;\r\n      case 'custom':\r\n        return column.totalsRowFormula;\r\n      default:\r\n        throw new Error(`Invalid Totals Row Function: ${column.totalsRowFunction}`);\r\n    }\r\n  }\r\n\r\n  get width() {\r\n    // width of the table\r\n    return this.table.columns.length;\r\n  }\r\n\r\n  get height() {\r\n    // height of the table data\r\n    return this.table.rows.length;\r\n  }\r\n\r\n  get filterHeight() {\r\n    // height of the table data plus optional header row\r\n    return this.height + (this.table.headerRow ? 1 : 0);\r\n  }\r\n\r\n  get tableHeight() {\r\n    // full height of the table on the sheet\r\n    return this.filterHeight + (this.table.totalsRow ? 1 : 0);\r\n  }\r\n\r\n  validate() {\r\n    const {table} = this;\r\n    // set defaults and check is valid\r\n    const assign = (o, name, dflt) => {\r\n      if (o[name] === undefined) {\r\n        o[name] = dflt;\r\n      }\r\n    };\r\n    assign(table, 'headerRow', true);\r\n    assign(table, 'totalsRow', false);\r\n\r\n    assign(table, 'style', {});\r\n    assign(table.style, 'theme', 'TableStyleMedium2');\r\n    assign(table.style, 'showFirstColumn', false);\r\n    assign(table.style, 'showLastColumn', false);\r\n    assign(table.style, 'showRowStripes', false);\r\n    assign(table.style, 'showColumnStripes', false);\r\n\r\n    const assert = (test, message) => {\r\n      if (!test) {\r\n        throw new Error(message);\r\n      }\r\n    };\r\n    assert(table.ref, 'Table must have ref');\r\n    assert(table.columns, 'Table must have column definitions');\r\n    assert(table.rows, 'Table must have row definitions');\r\n\r\n    table.tl = colCache.decodeAddress(table.ref);\r\n    const {row, col} = table.tl;\r\n    assert(row > 0, 'Table must be on valid row');\r\n    assert(col > 0, 'Table must be on valid col');\r\n\r\n    const {width, filterHeight, tableHeight} = this;\r\n\r\n    // autoFilterRef is a range that includes optional headers only\r\n    table.autoFilterRef = colCache.encode(row, col, row + filterHeight - 1, col + width - 1);\r\n\r\n    // tableRef is a range that includes optional headers and totals\r\n    table.tableRef = colCache.encode(row, col, row + tableHeight - 1, col + width - 1);\r\n\r\n    table.columns.forEach((column, i) => {\r\n      assert(column.name, `Column ${i} must have a name`);\r\n      if (i === 0) {\r\n        assign(column, 'totalsRowLabel', 'Total');\r\n      } else {\r\n        assign(column, 'totalsRowFunction', 'none');\r\n        column.totalsRowFormula = this.getFormula(column);\r\n      }\r\n    });\r\n  }\r\n\r\n  store() {\r\n    // where the table needs to store table data, headers, footers in\r\n    // the sheet...\r\n    const assignStyle = (cell, style) => {\r\n      if (style) {\r\n        Object.keys(style).forEach(key => {\r\n          cell[key] = style[key];\r\n        });\r\n      }\r\n    };\r\n\r\n    const {worksheet, table} = this;\r\n    const {row, col} = table.tl;\r\n    let count = 0;\r\n    if (table.headerRow) {\r\n      const r = worksheet.getRow(row + count++);\r\n      table.columns.forEach((column, j) => {\r\n        const {style, name} = column;\r\n        const cell = r.getCell(col + j);\r\n        cell.value = name;\r\n        assignStyle(cell, style);\r\n      });\r\n    }\r\n    table.rows.forEach(data => {\r\n      const r = worksheet.getRow(row + count++);\r\n      data.forEach((value, j) => {\r\n        const cell = r.getCell(col + j);\r\n        cell.value = value;\r\n\r\n        assignStyle(cell, table.columns[j].style);\r\n      });\r\n    });\r\n\r\n    if (table.totalsRow) {\r\n      const r = worksheet.getRow(row + count++);\r\n      table.columns.forEach((column, j) => {\r\n        const cell = r.getCell(col + j);\r\n        if (j === 0) {\r\n          cell.value = column.totalsRowLabel;\r\n        } else {\r\n          const formula = this.getFormula(column);\r\n          if (formula) {\r\n            cell.value = {\r\n              formula: column.totalsRowFormula,\r\n              result: column.totalsRowResult,\r\n            };\r\n          } else {\r\n            cell.value = null;\r\n          }\r\n        }\r\n\r\n        assignStyle(cell, column.style);\r\n      });\r\n    }\r\n  }\r\n\r\n  load(worksheet) {\r\n    // where the table will read necessary features from a loaded sheet\r\n    const {table} = this;\r\n    const {row, col} = table.tl;\r\n    let count = 0;\r\n    if (table.headerRow) {\r\n      const r = worksheet.getRow(row + count++);\r\n      table.columns.forEach((column, j) => {\r\n        const cell = r.getCell(col + j);\r\n        cell.value = column.name;\r\n      });\r\n    }\r\n    table.rows.forEach(data => {\r\n      const r = worksheet.getRow(row + count++);\r\n      data.forEach((value, j) => {\r\n        const cell = r.getCell(col + j);\r\n        cell.value = value;\r\n      });\r\n    });\r\n\r\n    if (table.totalsRow) {\r\n      const r = worksheet.getRow(row + count++);\r\n      table.columns.forEach((column, j) => {\r\n        const cell = r.getCell(col + j);\r\n        if (j === 0) {\r\n          cell.value = column.totalsRowLabel;\r\n        } else {\r\n          const formula = this.getFormula(column);\r\n          if (formula) {\r\n            cell.value = {\r\n              formula: column.totalsRowFormula,\r\n              result: column.totalsRowResult,\r\n            };\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  get model() {\r\n    return this.table;\r\n  }\r\n\r\n  set model(value) {\r\n    this.table = value;\r\n  }\r\n\r\n  // ================================================================\r\n  // TODO: Mutating methods\r\n  cacheState() {\r\n    if (!this._cache) {\r\n      this._cache = {\r\n        ref: this.ref,\r\n        width: this.width,\r\n        tableHeight: this.tableHeight,\r\n      };\r\n    }\r\n  }\r\n\r\n  commit() {\r\n    // changes may have been made that might have on-sheet effects\r\n    if (!this._cache) {\r\n      return;\r\n    }\r\n\r\n    // check things are ok first\r\n    this.validate();\r\n\r\n    const ref = colCache.decodeAddress(this._cache.ref);\r\n    if (this.ref !== this._cache.ref) {\r\n      // wipe out whole table footprint at previous location\r\n      for (let i = 0; i < this._cache.tableHeight; i++) {\r\n        const row = this.worksheet.getRow(ref.row + i);\r\n        for (let j = 0; j < this._cache.width; j++) {\r\n          const cell = row.getCell(ref.col + j);\r\n          cell.value = null;\r\n        }\r\n      }\r\n    } else {\r\n      // clear out below table if it has shrunk\r\n      for (let i = this.tableHeight; i < this._cache.tableHeight; i++) {\r\n        const row = this.worksheet.getRow(ref.row + i);\r\n        for (let j = 0; j < this._cache.width; j++) {\r\n          const cell = row.getCell(ref.col + j);\r\n          cell.value = null;\r\n        }\r\n      }\r\n\r\n      // clear out to right of table if it has lost columns\r\n      for (let i = 0; i < this.tableHeight; i++) {\r\n        const row = this.worksheet.getRow(ref.row + i);\r\n        for (let j = this.width; j < this._cache.width; j++) {\r\n          const cell = row.getCell(ref.col + j);\r\n          cell.value = null;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.store();\r\n  }\r\n\r\n  addRow(values, rowNumber) {\r\n    // Add a row of data, either insert at rowNumber or append\r\n    this.cacheState();\r\n\r\n    if (rowNumber === undefined) {\r\n      this.table.rows.push(values);\r\n    } else {\r\n      this.table.rows.splice(rowNumber, 0, values);\r\n    }\r\n  }\r\n\r\n  removeRows(rowIndex, count = 1) {\r\n    // Remove a rows of data\r\n    this.cacheState();\r\n    this.table.rows.splice(rowIndex, count);\r\n  }\r\n\r\n  getColumn(colIndex) {\r\n    const column = this.table.columns[colIndex];\r\n    return new Column(this, column, colIndex);\r\n  }\r\n\r\n  addColumn(column, values, colIndex) {\r\n    // Add a new column, including column defn and values\r\n    // Inserts at colNumber or adds to the right\r\n    this.cacheState();\r\n\r\n    if (colIndex === undefined) {\r\n      this.table.columns.push(column);\r\n      this.table.rows.forEach((row, i) => {\r\n        row.push(values[i]);\r\n      });\r\n    } else {\r\n      this.table.columns.splice(colIndex, 0, column);\r\n      this.table.rows.forEach((row, i) => {\r\n        row.splice(colIndex, 0, values[i]);\r\n      });\r\n    }\r\n  }\r\n\r\n  removeColumns(colIndex, count = 1) {\r\n    // Remove a column with data\r\n    this.cacheState();\r\n\r\n    this.table.columns.splice(colIndex, count);\r\n    this.table.rows.forEach(row => {\r\n      row.splice(colIndex, count);\r\n    });\r\n  }\r\n\r\n  _assign(target, prop, value) {\r\n    this.cacheState();\r\n    target[prop] = value;\r\n  }\r\n\r\n  /* eslint-disable lines-between-class-members */\r\n  get ref() {\r\n    return this.table.ref;\r\n  }\r\n  set ref(value) {\r\n    this._assign(this.table, 'ref', value);\r\n  }\r\n\r\n  get name() {\r\n    return this.table.name;\r\n  }\r\n  set name(value) {\r\n    this.table.name = value;\r\n  }\r\n\r\n  get displayName() {\r\n    return this.table.displyName || this.table.name;\r\n  }\r\n  set displayNamename(value) {\r\n    this.table.displayName = value;\r\n  }\r\n\r\n  get headerRow() {\r\n    return this.table.headerRow;\r\n  }\r\n  set headerRow(value) {\r\n    this._assign(this.table, 'headerRow', value);\r\n  }\r\n\r\n  get totalsRow() {\r\n    return this.table.totalsRow;\r\n  }\r\n  set totalsRow(value) {\r\n    this._assign(this.table, 'totalsRow', value);\r\n  }\r\n\r\n  get theme() {\r\n    return this.table.style.name;\r\n  }\r\n  set theme(value) {\r\n    this.table.style.name = value;\r\n  }\r\n\r\n  get showFirstColumn() {\r\n    return this.table.style.showFirstColumn;\r\n  }\r\n  set showFirstColumn(value) {\r\n    this.table.style.showFirstColumn = value;\r\n  }\r\n\r\n  get showLastColumn() {\r\n    return this.table.style.showLastColumn;\r\n  }\r\n  set showLastColumn(value) {\r\n    this.table.style.showLastColumn = value;\r\n  }\r\n\r\n  get showRowStripes() {\r\n    return this.table.style.showRowStripes;\r\n  }\r\n  set showRowStripes(value) {\r\n    this.table.style.showRowStripes = value;\r\n  }\r\n\r\n  get showColumnStripes() {\r\n    return this.table.style.showColumnStripes;\r\n  }\r\n  set showColumnStripes(value) {\r\n    this.table.style.showColumnStripes = value;\r\n  }\r\n  /* eslint-enable lines-between-class-members */\r\n}\r\n\r\nmodule.exports = Table;\r\n"],"file":"table.js"}
=======
{"version":3,"file":"table.js","names":["colCache","require","Column","constructor","table","column","index","_set","name","value","cacheState","filterButton","style","totalsRowLabel","totalsRowFunction","totalsRowResult","totalsRowFormula","Table","worksheet","validate","store","getFormula","Error","width","columns","length","height","rows","filterHeight","headerRow","tableHeight","totalsRow","assign","o","dflt","undefined","assert","test","message","ref","tl","decodeAddress","row","col","autoFilterRef","encode","tableRef","forEach","i","assignStyle","cell","Object","keys","key","count","r","getRow","j","getCell","data","formula","result","load","model","_cache","commit","addRow","values","rowNumber","push","splice","removeRows","rowIndex","arguments","getColumn","colIndex","addColumn","removeColumns","_assign","target","prop","displayName","displyName","displayNamename","theme","showFirstColumn","showLastColumn","showRowStripes","showColumnStripes","module","exports"],"sources":["../../../lib/doc/table.js"],"sourcesContent":["/* eslint-disable max-classes-per-file */\nconst colCache = require('../utils/col-cache');\n\nclass Column {\n  // wrapper around column model, allowing access and manipulation\n  constructor(table, column, index) {\n    this.table = table;\n    this.column = column;\n    this.index = index;\n  }\n\n  _set(name, value) {\n    this.table.cacheState();\n    this.column[name] = value;\n  }\n\n  /* eslint-disable lines-between-class-members */\n  get name() {\n    return this.column.name;\n  }\n  set name(value) {\n    this._set('name', value);\n  }\n\n  get filterButton() {\n    return this.column.filterButton;\n  }\n  set filterButton(value) {\n    this.column.filterButton = value;\n  }\n\n  get style() {\n    return this.column.style;\n  }\n  set style(value) {\n    this.column.style = value;\n  }\n\n  get totalsRowLabel() {\n    return this.column.totalsRowLabel;\n  }\n  set totalsRowLabel(value) {\n    this._set('totalsRowLabel', value);\n  }\n\n  get totalsRowFunction() {\n    return this.column.totalsRowFunction;\n  }\n  set totalsRowFunction(value) {\n    this._set('totalsRowFunction', value);\n  }\n\n  get totalsRowResult() {\n    return this.column.totalsRowResult;\n  }\n  set totalsRowResult(value) {\n    this._set('totalsRowResult', value);\n  }\n\n  get totalsRowFormula() {\n    return this.column.totalsRowFormula;\n  }\n  set totalsRowFormula(value) {\n    this._set('totalsRowFormula', value);\n  }\n  /* eslint-enable lines-between-class-members */\n}\n\nclass Table {\n  constructor(worksheet, table) {\n    this.worksheet = worksheet;\n    if (table) {\n      this.table = table;\n      // check things are ok first\n      this.validate();\n\n      this.store();\n    }\n  }\n\n  getFormula(column) {\n    // get the correct formula to apply to the totals row\n    switch (column.totalsRowFunction) {\n      case 'none':\n        return null;\n      case 'average':\n        return `SUBTOTAL(101,${this.table.name}[${column.name}])`;\n      case 'countNums':\n        return `SUBTOTAL(102,${this.table.name}[${column.name}])`;\n      case 'count':\n        return `SUBTOTAL(103,${this.table.name}[${column.name}])`;\n      case 'max':\n        return `SUBTOTAL(104,${this.table.name}[${column.name}])`;\n      case 'min':\n        return `SUBTOTAL(105,${this.table.name}[${column.name}])`;\n      case 'stdDev':\n        return `SUBTOTAL(106,${this.table.name}[${column.name}])`;\n      case 'var':\n        return `SUBTOTAL(107,${this.table.name}[${column.name}])`;\n      case 'sum':\n        return `SUBTOTAL(109,${this.table.name}[${column.name}])`;\n      case 'custom':\n        return column.totalsRowFormula;\n      default:\n        throw new Error(`Invalid Totals Row Function: ${column.totalsRowFunction}`);\n    }\n  }\n\n  get width() {\n    // width of the table\n    return this.table.columns.length;\n  }\n\n  get height() {\n    // height of the table data\n    return this.table.rows.length;\n  }\n\n  get filterHeight() {\n    // height of the table data plus optional header row\n    return this.height + (this.table.headerRow ? 1 : 0);\n  }\n\n  get tableHeight() {\n    // full height of the table on the sheet\n    return this.filterHeight + (this.table.totalsRow ? 1 : 0);\n  }\n\n  validate() {\n    const {table} = this;\n    // set defaults and check is valid\n    const assign = (o, name, dflt) => {\n      if (o[name] === undefined) {\n        o[name] = dflt;\n      }\n    };\n    assign(table, 'headerRow', true);\n    assign(table, 'totalsRow', false);\n\n    assign(table, 'style', {});\n    assign(table.style, 'theme', 'TableStyleMedium2');\n    assign(table.style, 'showFirstColumn', false);\n    assign(table.style, 'showLastColumn', false);\n    assign(table.style, 'showRowStripes', false);\n    assign(table.style, 'showColumnStripes', false);\n\n    const assert = (test, message) => {\n      if (!test) {\n        throw new Error(message);\n      }\n    };\n    assert(table.ref, 'Table must have ref');\n    assert(table.columns, 'Table must have column definitions');\n    assert(table.rows, 'Table must have row definitions');\n\n    table.tl = colCache.decodeAddress(table.ref);\n    const {row, col} = table.tl;\n    assert(row > 0, 'Table must be on valid row');\n    assert(col > 0, 'Table must be on valid col');\n\n    const {width, filterHeight, tableHeight} = this;\n\n    // autoFilterRef is a range that includes optional headers only\n    table.autoFilterRef = colCache.encode(row, col, row + filterHeight - 1, col + width - 1);\n\n    // tableRef is a range that includes optional headers and totals\n    table.tableRef = colCache.encode(row, col, row + tableHeight - 1, col + width - 1);\n\n    table.columns.forEach((column, i) => {\n      assert(column.name, `Column ${i} must have a name`);\n      if (i === 0) {\n        assign(column, 'totalsRowLabel', 'Total');\n      } else {\n        assign(column, 'totalsRowFunction', 'none');\n        column.totalsRowFormula = this.getFormula(column);\n      }\n    });\n  }\n\n  store() {\n    // where the table needs to store table data, headers, footers in\n    // the sheet...\n    const assignStyle = (cell, style) => {\n      if (style) {\n        Object.keys(style).forEach(key => {\n          cell[key] = style[key];\n        });\n      }\n    };\n\n    const {worksheet, table} = this;\n    const {row, col} = table.tl;\n    let count = 0;\n    if (table.headerRow) {\n      const r = worksheet.getRow(row + count++);\n      table.columns.forEach((column, j) => {\n        const {style, name} = column;\n        const cell = r.getCell(col + j);\n        cell.value = name;\n        assignStyle(cell, style);\n      });\n    }\n    table.rows.forEach(data => {\n      const r = worksheet.getRow(row + count++);\n      data.forEach((value, j) => {\n        const cell = r.getCell(col + j);\n        cell.value = value;\n\n        assignStyle(cell, table.columns[j].style);\n      });\n    });\n\n    if (table.totalsRow) {\n      const r = worksheet.getRow(row + count++);\n      table.columns.forEach((column, j) => {\n        const cell = r.getCell(col + j);\n        if (j === 0) {\n          cell.value = column.totalsRowLabel;\n        } else {\n          const formula = this.getFormula(column);\n          if (formula) {\n            cell.value = {\n              formula: column.totalsRowFormula,\n              result: column.totalsRowResult,\n            };\n          } else {\n            cell.value = null;\n          }\n        }\n\n        assignStyle(cell, column.style);\n      });\n    }\n  }\n\n  load(worksheet) {\n    // where the table will read necessary features from a loaded sheet\n    const {table} = this;\n    const {row, col} = table.tl;\n    let count = 0;\n    if (table.headerRow) {\n      const r = worksheet.getRow(row + count++);\n      table.columns.forEach((column, j) => {\n        const cell = r.getCell(col + j);\n        cell.value = column.name;\n      });\n    }\n    table.rows.forEach(data => {\n      const r = worksheet.getRow(row + count++);\n      data.forEach((value, j) => {\n        const cell = r.getCell(col + j);\n        cell.value = value;\n      });\n    });\n\n    if (table.totalsRow) {\n      const r = worksheet.getRow(row + count++);\n      table.columns.forEach((column, j) => {\n        const cell = r.getCell(col + j);\n        if (j === 0) {\n          cell.value = column.totalsRowLabel;\n        } else {\n          const formula = this.getFormula(column);\n          if (formula) {\n            cell.value = {\n              formula: column.totalsRowFormula,\n              result: column.totalsRowResult,\n            };\n          }\n        }\n      });\n    }\n  }\n\n  get model() {\n    return this.table;\n  }\n\n  set model(value) {\n    this.table = value;\n  }\n\n  // ================================================================\n  // TODO: Mutating methods\n  cacheState() {\n    if (!this._cache) {\n      this._cache = {\n        ref: this.ref,\n        width: this.width,\n        tableHeight: this.tableHeight,\n      };\n    }\n  }\n\n  commit() {\n    // changes may have been made that might have on-sheet effects\n    if (!this._cache) {\n      return;\n    }\n\n    // check things are ok first\n    this.validate();\n\n    const ref = colCache.decodeAddress(this._cache.ref);\n    if (this.ref !== this._cache.ref) {\n      // wipe out whole table footprint at previous location\n      for (let i = 0; i < this._cache.tableHeight; i++) {\n        const row = this.worksheet.getRow(ref.row + i);\n        for (let j = 0; j < this._cache.width; j++) {\n          const cell = row.getCell(ref.col + j);\n          cell.value = null;\n        }\n      }\n    } else {\n      // clear out below table if it has shrunk\n      for (let i = this.tableHeight; i < this._cache.tableHeight; i++) {\n        const row = this.worksheet.getRow(ref.row + i);\n        for (let j = 0; j < this._cache.width; j++) {\n          const cell = row.getCell(ref.col + j);\n          cell.value = null;\n        }\n      }\n\n      // clear out to right of table if it has lost columns\n      for (let i = 0; i < this.tableHeight; i++) {\n        const row = this.worksheet.getRow(ref.row + i);\n        for (let j = this.width; j < this._cache.width; j++) {\n          const cell = row.getCell(ref.col + j);\n          cell.value = null;\n        }\n      }\n    }\n\n    this.store();\n  }\n\n  addRow(values, rowNumber) {\n    // Add a row of data, either insert at rowNumber or append\n    this.cacheState();\n\n    if (rowNumber === undefined) {\n      this.table.rows.push(values);\n    } else {\n      this.table.rows.splice(rowNumber, 0, values);\n    }\n  }\n\n  removeRows(rowIndex, count = 1) {\n    // Remove a rows of data\n    this.cacheState();\n    this.table.rows.splice(rowIndex, count);\n  }\n\n  getColumn(colIndex) {\n    const column = this.table.columns[colIndex];\n    return new Column(this, column, colIndex);\n  }\n\n  addColumn(column, values, colIndex) {\n    // Add a new column, including column defn and values\n    // Inserts at colNumber or adds to the right\n    this.cacheState();\n\n    if (colIndex === undefined) {\n      this.table.columns.push(column);\n      this.table.rows.forEach((row, i) => {\n        row.push(values[i]);\n      });\n    } else {\n      this.table.columns.splice(colIndex, 0, column);\n      this.table.rows.forEach((row, i) => {\n        row.splice(colIndex, 0, values[i]);\n      });\n    }\n  }\n\n  removeColumns(colIndex, count = 1) {\n    // Remove a column with data\n    this.cacheState();\n\n    this.table.columns.splice(colIndex, count);\n    this.table.rows.forEach(row => {\n      row.splice(colIndex, count);\n    });\n  }\n\n  _assign(target, prop, value) {\n    this.cacheState();\n    target[prop] = value;\n  }\n\n  /* eslint-disable lines-between-class-members */\n  get ref() {\n    return this.table.ref;\n  }\n  set ref(value) {\n    this._assign(this.table, 'ref', value);\n  }\n\n  get name() {\n    return this.table.name;\n  }\n  set name(value) {\n    this.table.name = value;\n  }\n\n  get displayName() {\n    return this.table.displyName || this.table.name;\n  }\n  set displayNamename(value) {\n    this.table.displayName = value;\n  }\n\n  get headerRow() {\n    return this.table.headerRow;\n  }\n  set headerRow(value) {\n    this._assign(this.table, 'headerRow', value);\n  }\n\n  get totalsRow() {\n    return this.table.totalsRow;\n  }\n  set totalsRow(value) {\n    this._assign(this.table, 'totalsRow', value);\n  }\n\n  get theme() {\n    return this.table.style.name;\n  }\n  set theme(value) {\n    this.table.style.name = value;\n  }\n\n  get showFirstColumn() {\n    return this.table.style.showFirstColumn;\n  }\n  set showFirstColumn(value) {\n    this.table.style.showFirstColumn = value;\n  }\n\n  get showLastColumn() {\n    return this.table.style.showLastColumn;\n  }\n  set showLastColumn(value) {\n    this.table.style.showLastColumn = value;\n  }\n\n  get showRowStripes() {\n    return this.table.style.showRowStripes;\n  }\n  set showRowStripes(value) {\n    this.table.style.showRowStripes = value;\n  }\n\n  get showColumnStripes() {\n    return this.table.style.showColumnStripes;\n  }\n  set showColumnStripes(value) {\n    this.table.style.showColumnStripes = value;\n  }\n  /* eslint-enable lines-between-class-members */\n}\n\nmodule.exports = Table;\n"],"mappings":"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"}
>>>>>>> 95bdce0e2476f31a1a1d26b5d1f458cd5295e48d
